<!DOCTYPE html>
<html lang="en">
<head>
    <script>
        /*
        SETTINGS
        */

        // TEST :: Bool
        const TEST = true;

        // MIN_CHAR_VALUE :: Int
        const MIN_CHAR_VALUE = 32;

        // MAX_CHAR_VALUE :: Int
        const MAX_CHAR_VALUE = 127; // exclusive
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cryptml4</title>

    <style>
        /*
        GENERAL
        */

        :root
        {
            --color-primary: #384D48;
            --color-secondary: #ACAD94;

            font-size: calc(8px + 1vw);
            font-family: 'Courier New', Courier, monospace;
        }

        *
        {
            box-sizing: border-box;
            margin: 0;
        }
        
        body
        {
            padding: 2rem;
            max-width: 40rem;
            margin: auto;
        }

        /*
        PACIFIC
        */

        .header
        {
            margin-bottom: 1rem;
        }

        .main
        {
            display: flex;
            flex-direction: column;
        }

        .setting
        {
            padding: 0.5rem;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .setting:hover
        {
            cursor: pointer;
        }

        .password
        {
            padding: 0.5rem;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .password:focus
        {
            border: none;
            outline: 1px solid var(--color-secondary);
        }

        .text
        {
            padding: 0.5rem;
            font-size: 1rem;
            height: 10rem;
            margin-bottom: 8px;
            resize: none;
        }

        .text:focus
        {
            border: none;
            outline: 1px solid var(--color-secondary);
        }

        .go
        {
            padding: 0.5rem;
            font-size: 1rem;
            background-color: var(--color-primary);
            color: white;
            margin-bottom: 1rem;
        }

        .go:hover
        {
            cursor: pointer;
        }

        .about
        {
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <h1 class="header_h1">CRYPTML4</h1>
        <span class="header_hrs">
            <hr />
            <hr />
        </span>
    </header>

    <main class="main">

        <select class="setting" onchange="change_state()">
            <option class="setting_option" value="Encrypt" selected>Encrypt</option>
            <option class="setting_option" value="Decrypt">Decrypt</option>
        </select>

        <input class="password" placeholder="password" type="password" />
        
        <textarea class="text" placeholder="enter text here"></textarea>
        
        <button class="go" onclick="go()" type="button">
            <span class="go_icons">ðŸ§®ðŸ“‹</span>
            <span class="go_state">Encrypt</span>
            <span class="go_text">and copy text to clipboard.</span>
        </button>

        <section class="about">
            <h2>How do you use this?</h2>
            <ol>
                <li>Check that the setting is on "Encrypt".</li>
                <li>Enter a password.</li>
                <li>Enter the text you wish to encrypt.</li>
                <li>Click "Encrypt and copy text to clipboard."</li>
                <li>Send the encrypted message to a friend.</li>
                <li>
                    With the same password, and the setting on "Decrypt",
                    they will be able to decrypt your message on this
                    very same site.
                </li>
            </ol>
        </section>

    </main>

    <footer>
        <hr />
        <small>mtneugebauer1998@gmail.com</small>
    </footer>

    <script>
        // mod_neg :: Int -> Int -> Int
        const mod_neg = top => bot =>
        {
            let r;

            r = top % bot;
            r += bot;
            r %= bot;

            return r;
        };

        // cycle :: [a] -> Int -> a
        const cycle = xs => i =>
        {
            const new_i = mod_neg(i)(xs.length);
            return xs[new_i];
        };

        // shift_char :: Int -> Char -> Char
        const shift_char = delta => char => {
            const min = MIN_CHAR_VALUE;
            const max = MAX_CHAR_VALUE;
            const range = MAX_CHAR_VALUE - MIN_CHAR_VALUE;

            let r;

            r = char.charCodeAt(0);
            r -= min;
            r += delta;
            r = mod_neg(r)(range);
            r += min;
            r = String.fromCharCode(r);

            return r;
        };

        // sum :: [Int] -> Int
        const sum = xs =>
        {
            return xs.reduce((total, x) => total + x, 0);
        };

        // get_delta :: [[Int]] -> Int -> Int
        const get_delta = key => i =>
        {
            let r;

            r = key.map(k => cycle(k)(i));
            r = sum(r);

            return r;
        };

        // encrypt_offset :: [[Int]] -> Int -> String -> String
        const encrypt_offset = key => offset => text =>
        {
            let r = "";

            for(let i = 0; i < text.length; i++)
            {
                let r_i;

                r_i = get_delta(key)(i + offset);
                r_i = shift_char(r_i)(text[i]);

                r += r_i;
            }

            return r;
        };

        // negate_list :: [[Int]] -> [[Int]]
        const negate_list = xs =>
        {
            return xs.map(x => -x);
        };

        // negate_key :: [[Int]] -> [[Int]]
        const negate_key = key =>
        {
            return key.map(negate_list);
        };

        // password_to_offsets :: String -> [Int]
        const password_to_offsets = password =>
        {
            const min = MIN_CHAR_VALUE || 127;
            const max = MAX_CHAR_VALUE || 32;
            const range = max - min;

            let r = [];

            for(let i = 0; i < password.length; i++)
            {
                let r_i;

                r_i = password[i];
                r_i = r_i.charCodeAt(0);
                r_i += i * range;

                r.push(r_i);
            }

            return r;
        };

        // encrypt :: [[Int]] -> String -> String -> String
        const encrypt = key => password => text =>
        {
            const offsets = password_to_offsets(password);

            let r;

            r = encrypt_offset(key)(0)(text);

            for(let i = 0; i < offsets.length; i++)
            {
                r = encrypt_offset(key)(offsets[i])(r);
            }
            
            return r;
        };

        // decrypt :: [[Int]] -> String -> String -> String
        const decrypt = key => password => text =>
        {
            let r;

            r = negate_key(key);
            r = encrypt(r)(password)(text);

            return r;
        }

        /*
        UI
        */

        // $ :: String -> HTMLElement
        const $ = selector =>
        {
            return document.querySelector(selector);
        }

        // KEY :: [[Int]]
        const KEY = [[11,62],[65,4,5],[1,26,25,1,29],[49,37,24,56,56,68,51],[34,25,49,24,14,65,18,26,52,36,43],[5,43,30,54,49,12,64,14,29,0,31,16,26],[68,42,66,0,0,55,37,28,23,22,42,36,39,62,41,2,55],[65,41,39,21,27,22,31,0,18,40,54,38,34,11,34,47,28,0,36],[7,61,3,20,55,58,24,15,3,55,13,25,38,45,33,2,22,4,52,32,40,36,3],[53,35,33,52,39,2,61,14,59,52,34,26,38,26,61,23,61,41,56,53,0,60,42,55,7,59,59,14,44],[21,55,68,2,18,28,44,33,55,66,14,21,32,56,66,10,50,49,59,52,56,49,36,44,44,48,41,5,36,6,31],[16,18,18,13,1,42,59,44,18,5,25,50,38,60,20,0,1,0,57,34,8,65,59,38,44,43,32,39,19,47,4,30,22,63,66,61,27],[41,41,17,25,45,41,64,64,15,57,60,12,30,1,42,61,17,10,8,15,23,46,44,45,1,61,58,34,54,64,45,53,49,8,31,68,39,44,66,20,19],[5,13,27,36,58,56,57,44,2,11,48,1,46,23,42,22,18,52,40,36,28,33,5,58,31,56,45,10,67,19,50,19,21,17,21,39,2,47,31,14,2,58,20],[40,40,28,48,57,50,31,62,18,4,44,1,21,63,3,36,2,8,54,3,36,0,19,39,2,21,66,62,5,44,17,33,58,51,18,34,19,6,21,65,10,1,57,10,23,38,21],[4,21,22,17,9,42,5,63,11,6,25,3,56,5,56,64,18,17,25,16,9,38,61,63,46,64,35,12,22,51,4,36,24,33,26,13,1,36,24,6,46,49,60,13,20,45,25,39,62,18,41,2,14],[9,24,13,52,64,29,42,5,44,67,60,36,8,14,4,59,14,37,35,15,50,10,26,50,17,17,53,12,39,62,65,54,52,33,11,0,67,18,60,62,15,60,1,6,64,37,37,4,34,14,49,28,52,48,7,29,6,15,47],[61,64,36,42,17,2,55,60,44,34,25,42,35,38,53,54,66,13,15,46,19,54,41,53,57,55,57,26,18,53,0,40,16,27,16,18,52,20,48,21,51,24,56,48,44,17,1,29,30,45,25,65,30,43,5,21,25,37,20,17,21],[49,13,29,47,4,59,21,35,59,13,18,66,54,35,42,15,15,55,34,63,57,14,20,44,40,0,10,25,12,34,30,14,46,2,51,44,25,36,57,24,43,45,22,61,25,42,41,16,5,63,32,37,11,53,65,21,21,57,61,21,58,44,44,42,21,66,49],[10,7,52,66,3,51,51,36,56,43,48,52,62,28,11,29,28,39,4,18,53,25,58,3,68,50,47,20,40,14,53,65,67,48,60,25,1,16,33,19,16,58,48,46,67,31,37,12,20,57,64,51,33,43,46,60,48,44,4,0,49,64,10,59,29,10,50,13,31,28,4],[38,68,14,54,63,64,30,57,1,2,3,61,50,6,45,34,52,36,17,37,56,26,53,3,37,45,33,26,42,22,30,37,36,18,2,35,41,55,54,41,21,0,53,64,2,11,18,25,5,64,19,5,12,51,29,27,15,14,12,29,24,44,63,46,47,11,29,0,52,42,19,13,4],[32,51,9,15,57,34,40,46,46,20,34,1,15,59,17,61,56,38,51,11,40,56,59,21,28,44,34,24,27,29,46,11,27,3,30,45,30,44,36,38,41,57,20,65,22,58,15,56,52,18,11,68,22,15,19,14,58,56,53,1,39,43,52,30,34,24,33,24,7,63,35,34,20,26,22,68,20,32,64],[45,28,55,63,19,43,43,7,25,39,14,35,47,48,39,56,44,64,25,56,39,34,53,14,7,19,30,56,4,12,47,31,67,27,22,54,26,57,23,55,57,9,31,47,20,48,22,47,9,53,65,9,35,22,26,9,46,58,8,43,51,7,10,46,67,41,26,47,0,23,21,4,55,64,9,45,30,66,2,43,29,6,16],[14,53,59,9,6,10,22,36,48,39,59,47,16,29,54,12,65,7,34,47,34,29,11,56,42,60,57,62,13,5,49,25,13,68,41,55,63,36,38,56,38,2,64,12,50,25,41,58,21,65,1,15,8,51,27,35,25,57,24,48,12,11,68,15,17,15,54,64,0,26,30,51,61,11,14,58,0,67,5,44,60,65,30,51,23,55,22,53,0],[15,43,24,21,28,6,28,37,64,1,32,16,17,8,53,31,27,7,62,47,25,51,25,38,32,45,20,13,47,38,16,32,39,26,13,54,52,55,49,15,24,1,48,13,57,9,22,6,38,47,2,52,47,59,53,12,46,31,38,6,30,45,15,45,36,42,57,55,1,63,30,27,27,50,61,7,26,55,67,48,47,52,37,59,33,40,54,38,64,3,58,19,29,15,6,49,1],[6,54,16,57,38,52,60,43,36,22,61,23,36,37,46,24,27,1,15,68,41,50,8,49,22,45,22,18,14,65,10,68,9,14,31,49,29,64,61,62,3,52,40,4,3,34,62,11,58,41,15,60,67,66,67,8,46,28,12,4,16,42,38,2,52,64,52,1,57,48,31,4,45,38,6,10,5,64,2,11,29,18,32,13,12,60,21,60,55,12,13,3,52,35,30,20,6,34,1,57,17],[18,48,39,1,54,23,65,30,34,22,18,34,61,61,19,2,37,41,44,50,42,6,59,44,3,23,4,62,39,42,47,63,62,5,38,6,14,25,27,29,28,28,15,51,25,31,35,63,41,3,40,20,54,50,6,19,15,1,21,58,51,41,23,53,19,3,12,1,8,3,2,15,59,38,51,64,51,24,24,55,14,55,52,26,66,10,44,22,30,68,59,51,39,1,6,25,14,10,63,7,63,1,50],[57,58,6,6,62,62,42,62,12,29,61,21,37,17,27,41,44,10,32,37,24,42,37,19,53,41,67,10,32,11,23,26,1,27,6,49,21,40,27,60,26,3,41,37,61,8,17,36,58,1,16,57,58,68,6,8,46,60,6,48,13,27,13,3,48,37,37,18,64,12,55,58,58,25,5,68,5,9,3,51,60,46,54,57,52,29,68,30,60,60,5,4,43,16,25,43,20,60,44,61,10,35,53,32,66,27,35],[58,3,0,19,28,6,34,47,48,53,67,50,18,29,65,17,65,35,30,58,46,24,56,60,38,21,42,67,62,1,33,14,21,35,8,61,10,13,18,21,29,20,59,19,42,54,6,60,65,40,11,4,7,59,47,42,41,32,28,50,42,44,11,5,0,20,14,23,57,64,61,67,23,53,55,46,35,12,51,10,0,39,46,62,45,17,9,40,31,54,66,28,27,26,32,43,62,34,62,34,64,66,32,44,21,59,65,27,7],[27,58,9,19,37,16,59,19,29,29,58,38,27,53,12,62,45,5,6,56,7,14,52,19,20,13,6,4,14,17,23,6,47,35,15,18,23,56,42,49,22,22,33,55,23,51,26,22,18,55,59,37,12,65,25,24,18,24,51,22,18,26,65,47,56,24,30,12,43,28,56,18,15,17,55,65,31,33,24,41,34,25,65,32,44,43,56,41,63,33,58,42,19,33,22,27,23,34,19,49,63,22,5,64,64,27,34,62,18,50,52,47,24],[8,5,57,34,37,18,22,46,52,20,0,67,46,12,54,21,20,17,32,4,63,12,52,17,49,25,30,39,5,27,5,16,27,52,61,68,8,18,30,32,55,17,37,54,28,21,9,2,12,17,58,63,1,12,31,45,54,38,10,29,52,64,28,4,43,20,48,11,40,38,13,17,63,12,62,36,50,13,28,54,4,20,44,10,63,22,24,12,30,39,2,34,40,42,29,45,41,9,47,28,25,61,22,37,67,1,30,36,0,57,30,39,58,32,42,5,13,67,48,2,38,35,57,38,42,19,67],[14,68,33,51,51,20,35,17,67,34,29,48,33,39,59,51,0,55,62,50,35,60,39,68,16,26,12,64,3,18,47,9,66,52,36,8,27,49,58,65,17,48,60,65,19,63,45,41,54,3,52,8,10,51,1,6,27,29,35,48,49,35,25,65,54,0,68,28,63,8,8,46,67,53,21,2,49,20,23,54,36,33,26,25,17,13,48,42,28,44,0,26,65,22,38,39,44,12,14,10,68,35,6,14,51,32,32,61,22,23,40,27,18,47,47,52,61,37,9,37,54,6,52,50,9,24,38,50,48,61,43],[4,58,37,28,68,27,1,3,57,19,58,25,39,49,63,41,66,60,57,46,65,45,39,34,17,41,13,34,3,24,53,3,11,26,5,40,3,0,24,54,11,67,33,48,11,4,46,53,29,25,7,66,13,68,13,41,57,39,22,38,11,56,46,37,26,62,66,19,47,17,13,27,15,62,42,1,58,49,31,21,56,67,33,16,37,16,30,12,32,18,9,51,64,30,64,64,49,49,38,34,56,45,63,7,59,50,21,24,20,31,68,15,47,64,60,15,16,41,5,24,0,67,63,2,63,44,37,2,17,52,55,5,48,18,37,49,63],[19,11,6,19,17,25,5,49,49,25,51,24,49,61,0,2,56,14,16,36,46,53,22,13,20,7,6,43,7,33,45,57,9,6,50,15,48,36,6,38,27,13,56,2,12,17,10,2,30,31,46,68,65,56,29,28,38,5,58,26,37,33,22,25,56,61,67,19,21,27,18,67,57,57,67,35,28,17,6,12,42,12,23,62,44,9,3,35,20,60,66,60,63,30,27,49,12,0,55,46,38,1,17,27,23,24,63,27,61,36,16,16,18,52,22,61,17,67,62,56,51,62,15,50,19,19,39,43,12,8,55,52,55,56,13,35,34,67,18],[21,68,33,3,40,34,33,43,56,31,37,61,9,52,56,51,2,33,47,16,36,35,64,52,37,8,20,18,5,48,16,65,62,7,61,66,62,56,30,44,27,58,18,60,5,16,56,34,49,48,45,33,9,51,55,46,19,63,58,34,43,27,35,12,39,57,53,2,61,29,48,52,61,4,59,54,27,49,16,19,14,11,17,45,16,38,11,3,66,13,64,51,9,40,67,4,34,2,37,2,6,20,67,9,10,2,1,9,23,47,46,68,13,60,49,51,17,53,65,18,5,50,66,17,12,51,34,26,34,28,9,63,22,25,22,54,40,20,2,7,59,68,15,59,39,16,53,10,61],[1,33,16,3,15,45,34,37,9,66,21,61,24,65,58,15,21,57,7,21,22,13,21,55,66,62,49,48,36,17,38,11,7,10,63,32,6,41,44,32,18,48,18,42,66,25,61,39,40,29,52,17,3,59,9,42,10,15,59,63,57,58,30,24,26,5,1,9,5,48,66,28,12,37,41,53,68,13,67,12,43,25,29,4,57,8,25,17,50,3,65,0,58,10,37,34,32,15,49,14,7,24,21,3,15,10,68,59,49,41,59,23,54,14,18,36,34,9,28,22,24,38,0,10,16,55,56,15,58,50,38,16,13,66,0,18,40,63,16,17,43,59,42,55,57,55,65,52,35,20,59],[9,59,41,2,68,15,36,45,4,3,25,6,63,26,38,47,41,53,4,25,16,30,44,64,27,38,43,33,25,12,4,22,50,46,63,19,42,63,31,9,36,31,56,37,59,10,60,9,16,58,47,5,22,23,30,26,47,14,59,41,28,14,23,19,25,4,4,12,24,51,28,38,67,29,39,2,24,64,24,26,24,20,66,20,14,59,0,34,51,6,63,61,21,10,68,42,29,36,8,17,57,54,1,61,32,41,19,33,12,10,26,50,0,50,6,61,28,53,3,3,15,17,27,17,28,39,4,31,48,10,14,47,47,3,61,55,46,4,63,11,42,9,57,2,23,24,64,62,44,55,48,6,24,49,2,24,44],[56,45,10,1,30,53,5,21,5,44,57,65,27,63,14,41,17,41,30,40,18,54,7,40,6,13,52,29,27,55,44,9,62,32,42,15,61,61,17,42,50,52,13,27,16,53,36,6,4,3,30,27,57,39,7,28,57,15,42,64,6,21,13,44,38,38,26,4,3,14,57,41,60,55,65,13,18,63,9,45,44,20,16,27,62,37,11,68,17,66,28,3,59,40,32,54,29,63,10,43,23,19,23,63,40,41,8,25,39,11,13,60,52,37,67,34,24,39,27,42,52,39,47,16,36,33,61,39,62,61,3,12,55,16,50,54,11,63,34,31,43,1,1,54,63,61,39,60,42,27,50,18,28,31,63,39,33,50,54,31,3,60,19],[6,60,29,19,29,51,8,48,50,68,20,35,50,57,42,12,47,39,28,7,29,56,25,47,17,47,54,60,11,20,13,56,29,32,17,38,9,12,37,67,13,19,59,53,1,2,46,38,48,4,7,17,57,63,7,6,53,33,40,26,16,33,45,60,4,43,46,63,3,11,4,8,48,4,25,16,34,40,19,61,1,30,62,57,25,40,65,26,9,12,52,19,26,39,67,25,43,36,46,58,66,2,4,44,40,36,35,4,26,36,40,53,19,21,39,22,10,52,28,34,45,49,30,54,24,39,62,13,64,2,11,20,64,0,18,39,65,5,30,41,14,47,39,18,16,24,52,62,9,32,53,51,59,33,67,49,48,7,21,64,14,27,1,30,37,28,43],[26,51,60,29,5,6,35,41,18,32,29,53,47,25,42,42,8,48,24,30,36,55,26,23,52,2,24,13,59,31,28,19,0,9,14,53,42,55,11,60,27,9,5,44,0,18,37,37,40,26,41,1,44,22,3,27,59,26,49,62,42,2,51,67,11,53,35,14,28,21,44,66,1,31,21,18,48,57,1,24,47,5,1,41,36,24,35,67,3,49,10,65,51,8,50,57,23,46,60,46,34,65,27,24,55,20,8,35,65,62,9,66,4,22,59,66,32,6,15,16,19,25,40,66,35,37,0,14,38,45,13,40,42,40,33,24,20,7,56,54,50,60,51,62,41,44,40,63,4,44,48,34,57,7,23,67,33,34,45,56,1,10,60,34,52,0,33,17,57,12,12,57,9],[61,5,36,41,24,65,12,48,34,21,10,24,49,55,45,17,34,63,18,16,39,60,64,20,1,40,6,20,1,4,32,16,9,24,8,39,31,23,48,63,30,59,31,34,27,24,11,66,46,61,24,10,0,54,27,3,43,15,30,56,22,24,22,49,10,54,63,63,51,21,49,5,3,63,62,20,56,25,45,55,11,55,52,54,18,37,48,45,36,26,43,54,57,10,65,45,53,67,42,7,8,24,24,33,56,62,60,32,16,42,7,18,33,54,43,48,2,58,22,4,9,55,43,59,34,54,66,33,20,6,67,8,48,43,9,26,29,65,49,65,15,34,33,55,30,50,45,24,12,61,17,27,25,3,3,37,57,1,9,62,63,42,20,47,66,18,28,36,44,25,58,1,43,56,10,52,68,59,50],[36,55,59,52,60,5,66,15,61,9,55,39,29,52,25,51,60,6,11,65,14,48,49,52,42,6,29,16,41,52,37,67,29,63,8,1,41,62,21,19,3,45,56,8,21,51,25,13,9,13,13,6,38,44,61,34,0,46,13,66,14,33,2,5,63,0,67,4,63,41,54,57,44,27,45,10,25,16,44,33,67,26,32,0,31,47,55,6,41,18,43,19,64,17,44,14,18,16,51,50,15,14,4,41,12,43,51,48,40,29,27,42,38,14,28,0,37,10,21,19,12,52,54,65,41,37,35,39,5,31,63,44,65,31,12,39,0,13,43,6,40,66,8,14,45,54,20,59,34,12,0,49,18,25,25,8,19,42,28,0,45,22,38,46,21,32,59,18,26,1,28,54,55,62,58,22,55,58,26,58,12],[45,29,31,12,56,37,33,47,38,28,37,56,7,62,50,48,23,36,35,66,43,49,63,59,46,57,10,44,7,28,54,15,56,15,24,36,31,38,31,29,46,32,48,63,18,21,66,26,68,38,8,8,38,25,26,46,44,47,61,22,42,22,62,26,53,63,57,57,24,61,40,28,27,22,62,24,36,61,19,22,39,0,29,59,15,37,67,13,52,29,65,25,6,57,28,32,45,12,11,50,15,36,17,32,54,49,8,31,15,36,49,42,12,2,48,21,28,38,10,18,41,27,21,25,28,57,24,66,27,50,67,56,60,45,6,41,48,3,2,11,49,25,2,51,49,52,38,25,63,65,63,41,28,26,47,31,36,59,55,9,55,40,39,4,14,9,27,1,22,2,24,11,68,19,14,51,35,44,40,28,36,25,8,37,1,66,20,19,11,64,9],[45,54,59,27,20,21,37,42,1,10,3,54,63,55,26,13,55,29,32,52,64,3,7,67,45,28,18,20,22,30,40,25,20,66,2,43,30,38,16,44,60,65,42,35,67,57,67,11,5,64,4,54,33,15,59,16,21,64,48,46,33,23,13,27,35,18,68,62,7,53,26,56,19,31,65,50,5,48,65,53,12,58,66,18,6,48,46,13,20,38,11,37,46,17,68,22,66,54,62,34,7,58,38,14,37,28,31,7,13,18,24,24,35,17,51,63,56,12,25,50,3,40,53,48,49,36,9,64,63,13,61,52,5,67,3,52,18,24,17,36,64,4,51,15,67,22,34,2,13,0,61,0,44,12,60,61,52,41,65,4,38,37,67,43,29,11,16,16,38,45,41,0,14,32,51,65,38,47,57,19,16,52,14,17,51,28,60,25,19,36,60,21,15],[16,51,64,36,61,6,2,54,20,35,53,38,28,8,47,55,0,18,44,8,5,47,11,44,5,47,41,66,46,41,8,25,43,15,29,48,49,48,20,4,23,49,6,23,67,10,52,38,30,67,13,26,28,61,45,68,11,30,5,68,25,20,17,68,2,48,37,35,53,55,57,25,17,12,11,35,11,18,61,67,47,41,28,3,33,44,26,23,26,37,43,55,14,54,31,20,54,48,34,64,17,41,42,63,61,23,6,29,10,44,35,63,23,52,10,25,63,9,47,38,66,26,62,44,26,24,26,26,53,67,43,2,61,53,52,3,68,40,68,65,46,57,30,67,27,34,4,46,61,53,65,12,17,19,35,53,40,59,62,9,9,18,40,52,37,60,10,64,2,68,48,60,6,42,10,1,13,44,59,33,35,10,41,38,42,4,36,43,54,32,35,36,48,15,9,7,17],[65,5,63,9,7,20,18,53,16,29,54,53,52,20,46,13,55,9,59,3,68,35,5,44,60,4,61,25,16,18,45,10,62,19,2,27,21,47,28,44,37,44,48,58,61,46,7,52,27,1,1,48,24,7,25,32,1,56,36,51,50,26,21,55,17,48,40,29,56,34,18,0,58,32,6,15,31,68,61,34,26,35,11,37,5,51,52,46,24,66,57,10,29,15,40,65,3,37,29,40,30,1,7,0,55,57,53,41,25,67,16,67,57,59,67,66,53,8,52,10,1,45,61,53,0,12,34,4,3,36,59,20,42,46,62,42,29,57,55,12,27,44,47,64,6,58,16,34,46,19,31,13,22,34,17,30,24,59,62,45,24,66,31,30,57,66,24,63,45,52,58,9,39,11,24,24,36,13,33,46,47,9,6,26,8,48,1,24,55,32,6,33,65,64,3,50,19,55,64],[64,47,30,37,61,63,31,13,36,54,7,12,60,24,33,21,34,1,40,23,18,27,34,28,59,30,64,14,26,19,48,45,46,13,40,65,21,5,22,15,65,15,22,33,35,53,23,65,55,33,28,54,7,18,42,41,45,20,29,30,14,7,20,47,49,45,48,4,21,18,8,61,36,19,37,48,27,14,26,32,11,28,13,25,12,33,43,20,58,20,54,61,25,50,64,26,7,12,48,45,3,40,15,23,66,57,24,33,31,27,24,40,35,34,57,40,36,52,26,9,12,64,65,35,40,52,48,65,65,37,27,6,61,34,19,0,25,33,10,60,21,23,28,7,40,39,15,61,3,15,22,43,51,31,38,45,32,51,44,27,66,6,49,25,36,62,9,50,29,13,29,19,56,22,15,1,16,2,7,63,58,55,27,14,59,44,0,11,22,8,21,14,47,44,6,9,21,53,24,14,35,39,31,59,27,64,60,44,67,38,57],[1,51,40,5,43,56,30,56,11,65,10,51,50,15,58,49,21,5,55,64,66,45,24,24,32,56,10,1,31,10,59,53,37,24,55,25,33,5,63,0,8,61,15,24,50,32,45,60,61,50,19,17,15,7,30,34,40,65,27,26,14,65,10,20,28,39,12,48,43,40,65,26,1,24,52,15,40,55,10,17,13,31,21,27,54,36,66,15,9,41,40,60,29,9,3,53,15,26,67,59,27,34,68,31,65,65,35,48,2,1,65,62,32,54,12,5,24,64,20,0,2,15,42,64,18,48,53,60,39,13,17,35,6,12,29,34,48,25,11,7,21,49,11,7,4,34,46,7,4,24,37,13,54,57,27,47,59,26,40,65,17,29,8,61,50,43,26,16,23,50,62,9,58,32,1,37,50,19,18,3,19,28,31,24,66,2,31,55,48,45,50,27,56,16,10,20,62,22,23,64,14,5,57,6,63,21,53,11,17,2,17,51,9,31,17,57,44,50,50,26,51,1,20],[66,55,40,24,40,8,41,45,42,13,44,24,58,41,15,7,30,62,55,57,30,24,51,17,0,37,45,12,61,21,1,31,19,48,57,23,38,41,10,45,40,53,59,17,40,41,68,10,47,5,3,18,49,13,27,6,63,10,57,61,26,67,29,55,16,64,42,6,20,41,10,7,39,20,29,26,56,33,28,1,65,5,6,52,37,48,26,36,40,39,14,41,4,45,3,37,56,2,60,47,45,16,57,5,43,13,20,49,5,48,63,38,48,13,13,43,68,24,27,47,39,18,18,53,7,21,31,62,45,4,9,38,19,18,35,38,11,58,31,1,62,36,63,13,57,8,50,51,25,48,48,36,14,48,25,24,58,59,43,2,6,67,33,59,51,68,39,54,38,63,32,66,20,41,18,3,55,48,25,2,67,55,54,34,68,60,48,8,28,18,37,57,29,52,53,58,36,63,60,38,65,59,53,59,68,33,53,62,29,6,21,25,42,49,44,49,36,24,31,11,0,52,37,55,11,62,19],[10,23,35,4,20,20,35,18,24,49,55,65,9,11,20,16,34,41,19,15,52,57,1,3,35,44,3,26,10,0,4,12,22,21,22,46,65,55,29,54,36,5,56,34,0,58,54,21,68,52,66,63,24,22,11,32,52,55,13,45,49,46,18,15,50,14,67,7,44,47,35,61,62,48,18,12,34,44,67,1,9,10,46,36,13,48,29,59,5,68,63,15,53,31,9,42,62,39,67,13,9,0,15,67,54,17,12,12,67,10,64,9,58,19,59,60,3,40,49,27,42,32,16,0,30,10,17,1,37,16,61,62,18,33,57,59,53,43,25,5,29,31,59,38,38,35,34,30,65,42,45,32,31,35,50,51,54,42,5,24,37,14,55,57,28,30,68,45,5,58,11,62,31,50,40,38,56,37,66,12,30,11,0,34,0,40,5,8,30,48,62,26,38,35,35,17,52,63,51,17,28,55,24,38,59,2,25,34,13,50,25,60,54,21,29,16,17,22,30,46,6,29,53,53,46,10,63,16,68],[58,2,28,66,54,19,27,57,16,36,35,54,52,5,57,56,11,31,43,7,34,28,10,14,8,6,22,28,65,40,16,14,4,59,61,40,13,67,55,2,59,28,52,7,56,2,9,62,57,63,58,35,58,47,22,24,51,53,67,44,24,45,44,29,23,61,8,38,21,66,62,35,19,58,28,9,12,13,33,9,64,60,19,5,30,34,35,38,22,52,12,17,10,13,13,58,46,33,38,23,47,7,57,32,16,49,3,49,25,2,6,19,65,53,32,62,19,61,0,5,58,29,38,39,1,57,59,37,25,34,39,10,4,0,16,24,17,29,2,41,18,22,21,26,41,10,25,19,29,40,6,4,65,13,39,29,40,8,32,0,56,43,12,40,59,27,48,30,64,62,22,3,66,22,2,21,58,50,16,67,18,14,24,64,16,11,43,46,43,61,5,6,36,23,59,33,28,42,10,50,20,66,59,57,17,16,58,44,7,11,0,21,44,66,26,15,56,15,51,10,19,42,68,21,64,34,62,7,16,47,10,25,55],[32,16,34,17,20,1,68,51,63,3,8,53,33,54,37,67,34,37,67,66,39,36,9,23,63,47,54,17,61,21,33,34,40,23,53,23,29,20,44,31,64,50,44,1,57,50,23,21,22,12,50,59,52,42,63,22,24,65,34,57,13,0,65,21,56,30,4,27,58,54,22,17,68,21,60,11,55,9,13,9,60,5,63,66,5,40,30,26,44,61,56,55,24,6,4,16,0,58,50,27,17,8,7,35,14,64,2,38,16,47,29,20,32,48,47,45,17,31,55,38,0,63,60,24,58,40,47,26,60,39,20,65,37,67,20,10,49,41,0,43,8,62,4,54,3,60,67,26,45,8,36,47,64,44,61,0,19,48,60,50,51,47,2,8,43,16,50,46,26,40,54,18,25,26,19,30,64,32,17,62,63,50,7,51,58,67,11,56,11,10,55,36,18,24,23,16,2,48,23,36,37,19,11,57,50,58,66,60,14,64,5,53,59,64,47,9,54,5,50,20,2,64,29,61,63,64,19,12,21,25,62,56,64,43,12,57,45,57,57],[18,14,56,51,29,33,15,68,32,47,61,37,17,0,27,65,28,37,34,26,14,11,25,51,27,3,57,39,30,67,60,8,65,44,36,23,18,5,21,50,39,28,61,10,59,47,12,17,56,2,29,35,66,64,45,63,10,19,28,57,54,56,29,43,45,45,24,20,11,24,62,11,64,60,15,40,33,26,3,58,63,4,6,39,38,57,46,32,49,58,53,28,30,42,65,20,15,40,41,46,6,55,64,15,11,12,1,30,13,16,51,48,34,4,15,53,27,20,50,15,64,39,28,20,6,33,21,26,11,43,50,55,14,38,3,67,7,53,23,58,11,28,64,43,35,18,13,25,48,61,65,37,3,57,15,22,47,25,19,6,45,19,68,46,47,40,11,9,62,3,31,17,10,13,34,1,15,39,65,16,57,4,45,43,67,52,64,50,41,50,10,45,17,51,47,55,61,42,41,49,53,2,35,9,3,61,55,41,53,14,36,22,34,11,53,14,47,8,32,23,13,23,27,32,28,5,65,0,14,15,8,40,42,42,4,60,58,42,49,4,62],[2,41,66,67,47,16,34,49,9,44,55,68,0,51,16,49,18,27,41,41,4,40,41,56,14,46,26,20,10,43,39,29,10,57,11,30,50,30,35,53,57,22,37,55,38,62,23,54,54,54,12,56,58,20,39,42,2,52,49,28,47,7,6,47,35,42,51,10,36,21,17,53,49,32,15,65,24,4,63,62,67,9,55,40,29,24,31,31,63,53,45,52,27,35,33,43,26,6,47,6,13,27,65,15,4,20,29,66,36,46,23,36,61,12,34,49,24,37,52,1,40,43,9,12,36,2,45,60,47,14,6,49,45,50,53,68,32,52,28,19,49,14,46,21,48,19,8,58,35,11,24,68,49,53,66,1,66,38,16,39,53,31,10,19,41,4,63,6,11,23,29,36,24,58,14,54,58,40,24,60,58,16,57,49,58,3,44,21,23,42,12,21,38,36,20,55,49,0,59,4,60,57,41,44,35,68,28,42,54,23,13,8,53,2,27,9,35,39,17,5,1,43,9,9,37,6,56,59,68,67,9,65,9,51,9,21,32,4,48,44,33,28,39,48,2,58,16,5,51,42,68],[32,15,68,45,16,50,13,48,42,55,28,50,7,14,1,11,6,27,16,66,68,66,41,54,11,13,55,39,2,65,31,34,13,30,58,36,11,31,23,19,41,62,37,61,57,28,26,11,4,58,55,36,19,10,19,21,61,32,44,6,21,4,49,4,52,30,2,56,58,49,47,6,30,16,31,26,47,16,60,25,45,62,36,67,35,4,58,2,11,5,38,29,52,30,40,31,38,10,25,6,21,39,46,41,55,3,38,3,62,29,52,12,38,12,34,24,66,46,12,15,59,40,37,23,53,56,6,59,24,59,0,11,8,27,59,46,6,54,25,59,48,17,12,55,41,30,27,10,32,4,68,50,38,13,51,62,43,32,52,18,53,12,6,63,10,52,33,22,49,35,6,66,68,10,42,68,46,60,65,20,52,53,43,61,49,13,43,45,53,42,20,8,53,37,39,4,38,2,43,32,41,60,35,7,18,8,44,17,45,41,36,8,56,52,6,43,45,17,58,39,41,17,40,9,60,30,25,41,13,24,51,16,13,39,35,34,40,1,45,1,14,46,21,58,47,61,52,29,68,10,22,24,2,22,60,5,52],[53,40,42,53,20,0,59,57,20,6,61,39,42,13,15,68,31,3,35,26,61,46,48,36,41,9,20,45,57,19,54,11,66,19,32,56,67,19,35,40,66,37,62,42,68,46,17,15,2,54,57,11,42,10,59,34,56,2,64,4,43,50,6,53,46,28,0,43,56,3,31,2,55,0,55,36,2,47,50,24,39,60,35,42,45,68,7,19,5,0,59,39,12,29,43,19,29,42,11,15,27,12,44,24,16,29,2,62,17,30,10,43,46,0,50,12,56,15,46,55,61,43,27,9,44,1,4,28,15,23,50,39,8,4,56,64,57,5,15,48,15,56,35,38,12,30,2,18,40,29,44,37,37,61,17,11,49,22,50,15,34,26,57,62,56,25,13,6,18,7,12,41,46,29,31,18,7,62,22,28,40,44,44,57,49,8,53,67,67,62,58,4,15,57,40,39,20,17,4,3,59,35,22,4,61,30,51,10,67,34,15,16,35,6,42,17,63,13,29,59,8,16,34,55,40,43,49,56,13,36,26,21,14,25,13,9,6,30,47,7,4,3,60,31,63,61,3,59,21,16,67,36,28,44,47,17,63,64,42,62,14,20,5],[63,0,21,54,54,16,29,62,62,25,17,13,41,47,62,4,31,37,2,32,5,27,43,25,11,61,44,3,31,33,37,61,55,15,28,62,45,11,31,7,14,5,60,16,14,50,34,56,55,38,30,42,21,21,0,52,21,51,9,57,27,9,60,30,47,54,26,55,16,22,22,60,8,65,9,58,0,38,55,58,53,22,10,42,33,19,59,62,21,28,59,22,54,63,23,53,24,6,35,22,9,22,56,45,8,4,65,45,12,5,57,49,4,59,11,43,33,44,14,43,6,35,20,39,64,23,2,33,27,68,31,10,6,22,40,68,53,2,12,40,15,38,22,25,51,0,33,9,8,17,68,2,25,35,67,5,5,7,56,47,33,44,34,21,50,4,58,8,35,52,47,40,38,32,36,3,68,14,59,59,61,31,18,26,5,66,34,34,37,23,58,63,55,51,44,27,7,54,57,33,49,28,53,6,17,31,32,13,60,40,65,59,60,56,52,55,8,51,20,62,47,30,37,43,24,9,21,45,51,10,1,49,43,67,40,31,16,36,19,0,54,19,58,19,60,59,8,19,37,30,55,46,6,54,7,5,48,29,37,20,60,23,0,27,46,46,31,46,1],[21,31,12,55,65,10,26,10,6,60,62,53,23,30,46,30,25,31,58,2,21,20,13,28,32,43,55,42,3,59,33,51,11,7,40,28,4,34,43,7,5,37,33,62,17,1,55,61,67,22,21,66,64,61,3,47,65,39,11,11,46,8,15,29,26,9,63,59,4,59,3,14,3,1,28,16,8,49,30,48,8,58,21,50,40,45,66,10,0,7,47,16,23,27,51,45,8,41,63,38,49,67,52,14,3,58,41,48,29,6,61,57,48,30,22,12,53,48,48,5,33,55,24,26,35,10,38,30,39,2,21,1,63,23,17,40,44,49,19,8,61,24,44,48,54,62,46,17,56,25,55,16,57,3,24,21,43,12,31,51,17,37,3,2,54,6,66,9,68,54,43,50,0,65,53,22,8,64,26,36,11,25,29,61,4,33,64,42,24,31,43,65,16,56,17,39,40,24,35,54,15,64,32,64,16,17,10,24,9,18,60,1,19,23,35,27,67,8,58,18,10,41,23,14,24,16,46,59,63,34,62,29,6,9,18,53,13,55,54,19,27,55,14,67,18,13,44,36,13,42,66,25,10,67,38,34,24,31,6,12,5,61,4,65,6,54,66,53,57,64,59],[10,50,0,52,30,65,17,57,46,37,13,32,43,19,27,66,14,16,21,17,9,39,59,41,42,52,23,16,20,13,28,22,61,7,47,63,8,47,44,50,65,30,31,37,33,29,22,30,1,17,27,43,6,25,37,36,33,31,26,39,5,47,15,13,65,48,60,5,25,36,54,60,31,1,10,62,58,53,47,16,64,0,9,46,18,3,29,3,32,10,50,24,38,48,62,66,37,2,66,50,64,36,59,59,46,49,21,38,35,26,48,0,66,67,17,35,53,23,43,67,45,32,51,48,31,12,36,39,2,60,4,0,42,35,29,14,50,22,47,40,47,63,61,33,27,42,39,28,9,57,19,50,63,47,58,14,21,18,39,9,21,23,37,68,23,61,61,57,63,1,37,17,5,9,7,30,17,56,34,17,43,30,67,55,8,51,18,10,41,20,64,36,67,52,2,43,58,51,62,67,51,11,19,19,3,5,0,50,4,14,1,43,49,66,30,27,25,38,3,52,68,29,38,14,49,24,44,60,44,33,57,8,43,5,62,65,11,11,22,51,18,58,50,59,45,45,58,11,53,50,65,36,23,11,12,2,36,63,11,22,33,39,63,15,33,54,26,2,47,58,1,40,49,34,61,24,63],[20,65,15,11,39,17,17,47,25,3,14,5,13,39,58,23,17,13,10,49,57,62,55,9,24,23,8,31,50,18,50,59,44,17,49,19,60,37,64,58,54,4,15,64,32,65,58,36,66,18,65,15,33,28,46,11,33,29,14,43,20,56,56,53,35,21,23,4,33,56,43,35,47,2,15,35,59,41,14,49,66,7,47,23,62,18,61,43,41,44,68,26,61,52,42,28,17,56,37,20,49,37,15,6,32,46,8,5,24,64,59,54,35,27,37,15,21,41,47,31,8,67,68,49,28,55,10,63,20,55,15,52,7,3,56,60,20,43,60,28,57,36,2,3,67,22,50,9,64,16,23,17,23,42,24,52,28,15,64,2,64,52,11,53,36,64,65,32,36,22,49,55,34,36,30,51,46,55,30,37,59,22,45,12,51,10,3,5,43,15,22,54,63,46,31,15,48,43,67,5,16,8,61,37,28,16,5,61,17,63,31,0,38,49,51,65,57,32,60,65,49,7,56,38,61,32,26,49,59,45,3,48,50,66,6,46,24,37,9,38,9,44,45,2,42,18,41,34,53,44,33,52,50,53,50,2,49,47,57,4,58,30,51,38,48,11,32,62,49,12,38,41,44,3,11,7,37,17,51,45,31],[2,38,48,51,50,4,26,11,15,11,58,47,9,26,55,37,25,60,40,45,12,10,11,19,60,41,56,65,41,23,48,48,42,44,57,35,50,19,22,46,7,22,29,11,46,66,30,49,47,64,63,35,54,20,31,56,48,38,36,55,2,16,27,17,67,12,36,42,28,37,43,7,17,39,27,60,3,28,53,42,64,40,19,19,34,23,4,67,54,53,59,6,3,47,4,15,33,54,32,34,45,39,44,53,3,50,3,44,66,0,10,4,46,39,24,56,52,34,17,50,1,53,44,64,27,41,10,63,5,52,2,27,59,51,33,25,19,11,44,32,54,27,33,29,34,56,49,19,63,34,21,15,12,37,31,24,52,15,37,10,15,50,36,54,45,25,23,30,49,9,39,15,49,57,36,67,59,32,3,62,45,53,13,59,6,63,35,33,17,26,49,28,16,48,43,34,37,66,37,38,1,54,39,30,43,25,2,19,38,11,59,42,48,59,9,46,20,63,20,1,64,7,23,4,68,27,43,34,35,62,41,14,44,52,20,30,5,21,1,29,58,21,20,43,38,59,46,36,50,39,37,53,60,15,34,41,46,17,60,36,60,26,65,22,19,53,64,59,51,58,45,29,68,56,14,4,5,46,14,19,65,60,28],[52,10,36,60,51,40,2,60,63,41,36,4,47,38,19,3,37,44,46,9,24,32,29,9,46,21,47,9,58,11,58,4,54,18,48,65,38,5,63,54,6,40,38,30,9,6,50,68,23,47,46,26,3,57,67,31,49,54,41,50,1,48,39,12,60,35,40,44,6,27,41,63,59,43,52,44,23,18,63,50,38,4,49,33,49,63,39,14,33,67,62,21,39,8,19,21,26,52,58,2,9,9,26,21,27,2,46,14,40,8,57,40,20,34,48,68,50,12,61,62,57,8,65,39,30,10,16,41,10,39,32,44,39,10,4,10,50,41,14,9,14,29,57,43,35,33,39,9,26,9,39,6,11,9,36,34,64,27,28,68,62,12,53,8,4,39,18,52,47,36,36,22,30,30,32,28,17,52,65,3,28,46,2,15,3,68,47,10,22,12,32,3,13,33,31,17,47,0,44,44,66,10,1,63,60,32,64,49,52,11,44,27,52,1,59,53,62,67,60,2,4,42,1,65,60,64,66,41,11,63,0,16,38,61,20,27,11,11,53,59,30,5,6,49,4,24,59,25,16,5,20,30,17,42,54,4,16,55,34,34,43,16,47,18,49,68,38,33,64,1,5,41,52,34,53,61,38,8,49,26,16,55,62,32,36,19,33,53,9,4,23,5,10],[32,14,20,31,3,18,36,44,62,39,42,1,25,46,38,15,15,58,21,36,12,63,5,29,7,19,2,68,62,68,65,20,40,12,52,63,35,24,11,32,28,52,65,17,28,14,54,12,54,59,35,51,24,54,37,21,38,62,37,8,9,11,16,13,27,50,39,43,38,65,6,30,26,13,48,65,56,19,39,58,4,15,55,35,9,6,64,33,42,9,54,52,24,8,0,51,53,36,48,37,0,48,26,43,60,65,47,32,14,22,25,28,30,45,30,43,55,56,60,21,17,5,8,42,8,29,19,39,44,15,44,15,13,29,51,11,24,8,62,33,39,23,42,24,20,28,66,15,7,8,51,8,31,47,55,19,64,68,25,61,60,34,9,34,59,32,5,2,15,43,35,9,45,3,23,62,56,15,1,26,41,13,40,25,12,22,10,53,1,50,31,37,64,33,2,48,59,61,44,4,26,32,3,18,58,40,16,2,46,25,61,62,17,45,53,52,30,27,5,45,2,27,56,22,66,20,43,41,26,38,39,30,20,46,68,41,66,47,16,64,8,7,35,66,44,41,48,45,45,38,44,66,33,44,17,19,5,6,61,5,52,59,10,16,42,24,31,7,32,56,41,19,27,30,13,14,23,48,10,68,55,15,27,49,39,14,60,61,36,28,47,2,6,4,52,64,37,31,24,53,49,10,3,61,67,4,5],[42,30,31,16,62,42,3,15,8,11,21,11,39,23,32,60,49,16,14,34,26,53,49,5,61,30,49,36,3,56,51,36,53,38,12,5,46,38,5,8,8,1,39,1,65,40,6,19,57,22,8,7,6,10,9,4,42,30,49,36,47,53,27,8,59,21,68,49,51,17,46,50,58,3,31,0,43,29,4,47,20,49,9,2,18,53,26,65,68,24,63,51,13,34,32,54,45,8,8,50,62,39,14,37,41,10,61,26,17,23,47,37,38,42,27,44,28,37,21,39,47,19,8,15,34,53,15,56,15,27,7,56,20,58,28,58,64,15,21,4,64,31,61,52,40,7,12,40,41,52,31,25,13,58,42,32,62,3,41,10,53,7,58,32,29,15,53,42,27,21,10,41,46,49,60,6,31,35,43,59,65,23,63,1,62,59,56,11,18,46,49,68,65,35,55,0,45,47,19,41,55,50,46,43,45,57,8,48,24,46,4,1,15,6,67,4,44,14,68,60,46,48,48,61,22,42,61,60,7,33,14,47,30,53,10,21,12,57,15,16,5,55,29,12,18,27,59,0,40,32,1,46,6,57,68,32,19,21,25,22,44,0,61,65,36,67,5,23,65,57,19,44,4,44,28,28,41,24,28,40,18,42,21,5,36,46,54,64,41,21,58,12,48,10,29,49,44,35,1,18,60,44,61,8,42,4,50,49,54,34,58],[54,52,50,62,10,53,26,31,38,43,38,26,65,10,28,0,52,8,9,50,18,20,14,59,24,25,21,30,54,48,37,56,58,18,46,33,47,27,6,8,51,50,36,6,1,53,9,65,21,30,52,4,44,48,7,48,40,48,23,34,27,16,37,49,55,23,65,37,67,31,53,10,9,66,66,48,47,62,57,22,42,41,7,15,17,23,57,49,21,55,11,14,2,9,34,49,10,35,68,37,52,3,15,42,32,5,2,35,7,35,66,11,22,56,43,14,68,58,17,5,4,24,17,52,7,59,66,2,11,44,65,57,51,13,22,47,1,59,30,50,14,14,19,28,50,48,52,56,44,34,1,45,26,35,19,13,55,28,13,18,35,68,17,7,40,29,41,47,34,63,49,9,24,42,65,7,60,46,7,33,53,68,14,35,52,52,65,48,8,65,13,33,46,3,37,45,47,53,33,51,14,12,23,14,57,20,61,30,57,40,29,22,13,50,18,9,6,48,61,48,1,22,63,39,54,68,10,39,45,38,12,4,31,46,16,44,23,56,59,28,24,17,24,1,35,19,17,39,61,62,50,21,0,28,21,40,29,59,4,41,61,8,48,1,46,55,47,53,50,18,16,21,52,28,34,21,50,9,58,40,28,27,18,65,15,67,35,45,53,58,44,43,39,42,25,48,24,59,26,6,7,66,39,48,19,19,40,45,14,51,17,20,9],[60,19,24,40,4,68,64,29,0,6,42,42,31,4,16,9,27,33,10,6,63,16,36,15,44,63,65,8,60,29,14,52,45,8,64,54,57,8,11,35,48,37,38,5,43,11,40,23,55,8,39,68,59,19,18,61,12,9,49,33,68,33,20,66,21,21,66,62,39,17,63,51,60,29,3,57,3,13,60,17,51,3,54,67,11,42,4,49,27,68,52,23,5,45,45,8,10,62,43,67,61,7,26,16,30,15,43,25,0,4,0,0,12,8,55,18,57,39,28,5,28,48,30,41,24,66,40,67,2,12,41,68,24,17,38,1,41,67,34,53,47,58,42,29,37,19,14,24,48,39,57,0,50,14,63,55,43,33,64,19,56,52,1,34,14,56,59,61,63,45,39,9,57,56,55,2,41,25,29,36,16,27,61,66,0,60,52,47,1,38,63,13,23,43,36,34,30,6,53,66,15,48,2,27,52,9,22,44,35,38,32,57,39,38,36,4,63,53,43,17,43,16,2,61,58,7,0,6,23,44,58,9,64,46,25,43,25,14,44,66,4,64,66,22,25,64,57,58,35,26,26,53,60,24,62,52,15,64,33,27,65,14,21,0,0,36,68,56,11,30,10,36,43,53,37,35,67,25,17,65,16,65,65,66,18,6,62,44,9,58,5,0,53,35,23,41,18,60,67,68,35,12,2,41,32,51,66,43,53,65,27,49,17,67,0,57,40],[21,21,30,25,64,48,16,52,48,23,8,47,31,22,27,13,39,61,31,16,15,46,30,44,44,49,4,46,6,40,42,7,49,28,50,4,2,60,49,43,58,53,42,34,10,45,59,51,0,68,46,22,54,11,0,41,57,38,4,13,35,8,46,44,10,0,22,39,16,55,24,8,26,22,40,47,17,4,13,7,61,30,66,52,27,42,27,17,9,21,42,46,45,52,10,39,67,65,2,38,1,5,38,66,45,62,3,46,27,31,42,25,51,67,28,7,23,37,32,16,49,56,50,63,0,36,42,40,2,4,6,9,49,10,38,17,41,36,3,16,67,45,8,6,42,46,16,64,2,40,58,28,2,31,49,57,45,39,22,37,5,42,2,1,32,51,66,13,56,50,37,30,64,36,51,5,52,16,27,26,49,16,40,58,9,11,13,35,55,30,50,58,0,54,30,56,27,27,26,33,24,41,47,33,44,58,41,66,1,9,17,25,58,10,66,16,12,16,49,58,47,16,8,52,13,15,32,47,27,63,62,4,61,34,40,24,39,7,15,14,22,2,56,14,54,25,46,56,10,12,10,31,48,67,49,14,2,26,38,16,20,13,42,64,40,60,47,66,31,23,2,24,66,0,35,7,20,5,17,28,0,61,26,64,66,60,15,28,7,21,5,36,52,4,64,36,48,28,4,27,44,25,39,29,59,10,57,45,34,46,18,40,44,35,40,7,41,51,2,0,43,54,59,62,56,61,37,45,55,13,52],[58,54,56,51,35,6,9,56,26,48,65,53,28,28,54,55,48,3,59,68,62,17,68,4,49,46,65,65,30,68,0,36,65,55,64,57,53,13,53,24,53,15,30,57,47,19,5,63,15,17,28,8,14,42,42,7,6,62,66,19,48,26,39,58,18,63,54,17,9,20,64,7,52,33,29,14,38,58,55,37,51,57,7,65,3,42,27,10,13,38,15,68,56,60,41,26,31,68,59,25,8,52,15,31,2,24,20,7,3,0,48,30,26,65,64,56,5,19,55,5,10,40,10,49,46,49,20,26,8,52,16,67,24,62,29,8,67,29,39,54,43,10,6,37,30,1,13,45,11,11,12,47,55,22,55,47,23,8,60,40,52,52,65,44,7,46,50,37,45,7,47,48,23,1,27,32,33,48,65,11,10,29,26,65,40,49,11,21,49,5,41,61,67,34,7,37,60,13,3,47,54,7,60,12,15,45,68,43,12,10,19,23,11,1,47,4,50,3,1,61,43,58,37,1,25,49,45,19,4,39,29,37,15,4,67,21,37,54,37,65,31,13,62,3,10,2,64,16,25,47,9,12,29,51,34,30,29,10,18,12,60,58,14,57,57,33,48,29,25,57,3,34,37,2,22,46,18,21,53,34,36,25,12,9,66,43,23,63,61,42,21,67,3,63,38,56,29,32,1,57,56,3,24,29,18,66,9,53,27,33,67,32,6,47,16,8,55,42,61,9,18,1,27,60,41,65,59,7,3,1,10,52,0,51,21,22,14],[35,2,57,5,21,42,67,28,61,7,56,6,15,67,17,66,38,12,59,45,36,54,20,45,43,60,52,50,41,27,41,62,23,47,63,37,0,57,18,51,27,0,29,32,41,44,16,57,4,45,26,19,19,11,12,12,51,62,33,32,56,44,32,43,0,11,28,13,14,2,54,46,47,8,14,62,64,46,21,49,66,22,52,40,4,10,9,68,11,39,21,4,32,60,57,10,1,51,36,2,48,55,35,50,20,45,16,1,48,39,1,40,14,49,16,18,59,23,17,44,9,66,15,67,49,29,44,45,37,28,40,42,23,2,29,62,59,60,5,17,67,38,28,9,28,2,0,33,49,25,23,8,22,2,7,22,30,58,46,51,66,4,42,10,57,22,66,22,10,14,2,27,0,50,44,5,27,1,0,31,8,16,6,55,17,59,40,38,55,17,11,68,63,42,61,30,49,35,15,28,67,63,64,50,38,45,53,18,58,35,45,29,1,53,21,46,6,61,49,19,25,48,11,40,44,34,39,16,44,66,27,45,54,11,26,49,65,36,50,22,55,42,17,31,11,49,19,19,33,14,14,65,49,20,47,37,25,17,42,58,19,41,57,35,33,42,27,61,40,19,24,14,2,10,17,48,1,9,23,51,68,21,42,0,56,2,27,10,57,58,6,60,42,54,19,1,15,12,57,37,39,37,58,23,61,46,48,5,12,37,62,60,29,62,36,6,20,31,26,3,41,67,53,38,17,35,53,27,63,52,2,0,26,43,65,60,29,26,58,24,60,5,64,17,28,57,49]];

        // change_state :: () -> ()
        const change_state = () =>
        {
            const state = $(".setting").value;
            $(".go_state").innerHTML = state;
        }

        // go :: () -> ()
        const go = () =>
        {
            const key = KEY;
            const state = $(".setting").value;
            const password = $(".password").value;

            let r = $(".text").value;

            if(state === "Encrypt")
            {
                r = encrypt(key)(password)(r);
            }
            else // state === "Decrypt"
            {
                r = decrypt(key)(password)(r);
            }

            $(".text").value = r;
            navigator.clipboard.writeText(r);

            alert("Done!");
        }
    </script>
</body>
</html>

<script>

// arrays_eq :: [a] -> [b] -> Bool
const arrays_eq = xs => ys =>
{
    return JSON.stringify(xs) === JSON.stringify(ys);
}

// assert :: (() -> Bool) -> ()
const assert = f =>
{
    const result = f();

    if(result === undefined)
    {
        console.log(`ASSERTION UNDEFINED:\n${f}`);
    }

    if(result === false)
    {
        console.log(`ASSERTION FAILED:\n${f}`);
    }
}

if (TEST)
{
    // assert
    assert(() => 2 === 1 + 1);

    // arrays_eq
    assert(() => arrays_eq([1])([1]));

    // mod_neg
    assert(() => 4 === mod_neg(-1)(5));

    // cycle
    assert(() =>
    {
        const xs = [1, 2];

        return 2 === cycle(xs)(-1);
    });

    // shift_char
    assert(() => shift_char(1)('a') === 'b');

    // sum
    assert(() => 2 === sum([1, 0, 1]));

    // get_delta
    assert(() =>
    {
        const key = [[1, 2], [2, 3, 4]];
        
        return 6 === get_delta(key)(-1);
    });

    // encrypt_offset
    assert(() =>
    {
        const key = [[1], [1, 2]];
        const text = "AAA";
        
        return "CDC" === encrypt_offset(key)(0)(text);
    });

    // negate_list
    assert(() => 
    {
        const xs = [1, 2];

        const expected = [-1, -2];
        const observed = negate_list(xs);

        return arrays_eq(expected)(observed);
    });

    // negate_key
    assert(() => 
    {
        const key = [[1], [1, 2]];

        const expected = [[-1], [-1, -2]];
        const observed = negate_key(key);

        return arrays_eq(expected)(observed);
    });

    // password_to_offsets
    assert(() => 
    {
        const password = "ab";
        const min = MIN_CHAR_VALUE;
        const max = MAX_CHAR_VALUE;
        const range = max - min;

        const expected =
        [
            "a".charCodeAt(0) + (0 * range),
            "b".charCodeAt(0) + (1 * range),
        ];
        const observed = password_to_offsets(password);

        return arrays_eq(expected)(observed);
    });

    // encrypt
    // decrypt
    assert(() =>
    {
        const text = "I love pizza";
        const key_1 = [[1], [2, 3]];
        const key_2 = [[4]];
        const password_1 = "asdf"
        const password_2 = ""

        let success = true;
        let r;

        r = encrypt(key_1)(password_1)(text);

        success &&= r != text;
        success &&= r != encrypt(key_1)(password_2)(text);
        success &&= r != encrypt(key_2)(password_1)(text);

        r = decrypt(key_1)(password_1)(r);

        success &&= r === text;

        return success;
    });
}

</script>