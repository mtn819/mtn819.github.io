<!DOCTYPE html>
<html lang="en">
<head>
    <script>
        /*
        SETTINGS
        */

        // TEST :: Bool
        const TEST = true;

        // MIN_CHAR_VALUE :: Int
        const MIN_CHAR_VALUE = 32;

        // MAX_CHAR_VALUE :: Int
        const MAX_CHAR_VALUE = 127; // exclusive
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cryptml4</title>

    <style>
        /*
        GENERAL
        */

        :root
        {
            --color-primary: #384D48;
            --color-secondary: #ACAD94;

            font-size: calc(8px + 1vw);
            font-family: 'Courier New', Courier, monospace;
        }

        *
        {
            box-sizing: border-box;
            margin: 0;
        }
        
        body
        {
            padding: 2rem;
            max-width: 40rem;
            margin: auto;
        }

        /*
        PACIFIC
        */

        .header
        {
            margin-bottom: 1rem;
        }

        .main
        {
            display: flex;
            flex-direction: column;
        }

        .setting
        {
            padding: 0.5rem;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .setting:hover
        {
            cursor: pointer;
        }

        .password
        {
            padding: 0.5rem;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .password:focus
        {
            border: none;
            outline: 1px solid var(--color-secondary);
        }

        .text
        {
            padding: 0.5rem;
            font-size: 1rem;
            height: 10rem;
            margin-bottom: 8px;
            resize: none;
        }

        .text:focus
        {
            border: none;
            outline: 1px solid var(--color-secondary);
        }

        .go
        {
            padding: 0.5rem;
            font-size: 1rem;
            background-color: var(--color-primary);
            color: white;
            margin-bottom: 1rem;
        }

        .go:hover
        {
            cursor: pointer;
        }

        .about
        {
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <h1 class="header_h1">CRYPTML4</h1>
        <span class="header_hrs">
            <hr />
            <hr />
        </span>
    </header>

    <main class="main">

        <select class="setting" onchange="change_state()">
            <option class="setting_option" value="Encrypt" selected>Encrypt</option>
            <option class="setting_option" value="Decrypt">Decrypt</option>
        </select>

        <input class="password" placeholder="password" type="password" />
        
        <textarea class="text" placeholder="enter text here"></textarea>
        
        <button class="go" onclick="go()" type="button">
            <span class="go_icons">ðŸ§®ðŸ“‹</span>
            <span class="go_state">Encrypt</span>
            <span class="go_text">and copy text to clipboard</span>
        </button>

        <section class="about">
            <h2>How do you use this?</h2>
            <ol>
                <li>Check that the setting is on "Encrypt".</li>
                <li>Enter a password.</li>
                <li>Enter the text you wish to encrypt.</li>
                <li>Click "Encrypt and copy text to clipboard".</li>
                <li>Send the encrypted message to a friend.</li>
                <li>
                    With the same password, and the setting on "Decrypt",
                    they will be able to decrypt your message on this
                    very same site.
                </li>
            </ol>
        </section>

    </main>

    <footer>
        <hr />
        <small>mtneugebauer1998@gmail.com</small>
    </footer>

    <script>
        // mod_neg :: Int -> Int -> Int
        const mod_neg = top => bot =>
        {
            let r;

            r = top % bot;
            r += bot;
            r %= bot;

            return r;
        };

        // cycle :: [a] -> Int -> a
        const cycle = xs => i =>
        {
            const new_i = mod_neg(i)(xs.length);
            return xs[new_i];
        };

        // shift_char :: Int -> Char -> Char
        const shift_char = delta => char => {
            const min = MIN_CHAR_VALUE;
            const max = MAX_CHAR_VALUE;
            const range = MAX_CHAR_VALUE - MIN_CHAR_VALUE;

            let r;

            r = char.charCodeAt(0);
            r -= min;
            r += delta;
            r = mod_neg(r)(range);
            r += min;
            r = String.fromCharCode(r);

            return r;
        };

        // sum :: [Int] -> Int
        const sum = xs =>
        {
            return xs.reduce((total, x) => total + x, 0);
        };

        // get_delta :: [[Int]] -> Int -> Int
        const get_delta = key => i =>
        {
            let r;

            r = key.map(k => cycle(k)(i));
            r = sum(r);

            return r;
        };

        // encrypt_offset :: [[Int]] -> Int -> String -> String
        const encrypt_offset = key => offset => text =>
        {
            let r = "";

            for(let i = 0; i < text.length; i++)
            {
                let r_i;

                r_i = get_delta(key)(i + offset);
                r_i = shift_char(r_i)(text[i]);

                r += r_i;
            }

            return r;
        };

        // negate_list :: [[Int]] -> [[Int]]
        const negate_list = xs =>
        {
            return xs.map(x => -x);
        };

        // negate_key :: [[Int]] -> [[Int]]
        const negate_key = key =>
        {
            return key.map(negate_list);
        };

        // password_to_offsets :: String -> [Int]
        const password_to_offsets = password =>
        {
            const min = MIN_CHAR_VALUE || 127;
            const max = MAX_CHAR_VALUE || 32;
            const range = max - min;

            let r = [];

            for(let i = 0; i < password.length; i++)
            {
                let r_i;

                r_i = password[i];
                r_i = r_i.charCodeAt(0);
                r_i += i * range;

                r.push(r_i);
            }

            return r;
        };

        // encrypt :: [[Int]] -> String -> String -> String
        const encrypt = key => password => text =>
        {
            const offsets = password_to_offsets(password);

            let r;

            r = encrypt_offset(key)(0)(text);

            for(let i = 0; i < offsets.length; i++)
            {
                r = encrypt_offset(key)(offsets[i])(r);
            }
            
            return r;
        };

        // decrypt :: [[Int]] -> String -> String -> String
        const decrypt = key => password => text =>
        {
            let r;

            r = negate_key(key);
            r = encrypt(r)(password)(text);

            return r;
        }

        /*
        UI
        */

        // $ :: String -> HTMLElement
        const $ = selector =>
        {
            return document.querySelector(selector);
        }

        // KEY :: [[Int]]
        const KEY = [[17,18],[31,39,7],[24,14,5,32,44],[65,38,5,26,63,24,36],[5,9,46,8,38,23,28,68,38,45,44],[31,48,50,25,43,51,36,46,25,32,1,40,31],[52,23,25,67,45,38,0,4,57,14,31,27,24,19,18,14,19],[64,48,49,35,48,25,8,60,26,2,41,49,37,38,35,59,48,52,5],[9,9,65,15,0,68,20,14,55,13,8,68,63,63,41,65,66,37,18,34,43,68,66],[66,31,64,51,33,4,8,68,2,0,7,7,21,43,34,36,9,9,53,16,21,56,6,17,56,18,39,32,31],[17,21,63,28,26,19,7,20,12,52,38,62,40,39,37,37,36,47,1,39,2,8,42,18,65,64,45,12,26,54,39],[3,58,63,36,64,17,41,8,47,68,47,29,40,43,2,66,8,68,3,41,2,24,33,47,6,46,8,10,25,23,6,33,7,22,49,19,65],[8,37,12,6,16,50,37,33,21,26,58,51,5,65,44,6,53,0,13,35,16,42,32,3,55,3,3,7,33,50,20,13,0,21,48,49,28,24,21,55,46],[24,57,5,67,28,40,67,50,60,59,1,1,3,27,55,8,5,41,45,11,13,3,18,65,55,56,68,9,56,65,5,58,10,0,13,32,43,18,16,40,25,38,62],[31,18,11,18,58,50,35,13,48,58,41,14,28,34,3,27,41,24,52,19,68,34,55,48,6,19,29,56,13,4,25,18,30,33,25,36,47,38,3,41,52,67,41,10,36,60,43],[35,35,55,31,44,21,13,59,40,59,28,60,29,37,19,53,12,61,43,13,40,67,23,33,68,6,16,12,10,29,1,18,50,44,54,67,34,30,47,53,41,28,37,7,55,46,40,46,26,67,57,19,5],[14,27,66,35,51,56,16,28,34,7,38,28,48,50,17,6,39,34,44,35,19,67,51,12,43,41,63,32,37,41,25,40,67,41,16,65,56,65,64,55,66,12,16,38,2,0,34,49,13,66,42,6,48,13,55,51,66,25,45],[30,59,65,65,59,30,46,61,68,25,39,14,43,10,48,64,65,65,9,56,38,66,24,21,58,55,13,32,2,0,23,9,9,64,19,16,67,50,49,43,29,22,45,37,12,40,33,27,37,66,37,59,54,41,60,40,46,35,55,9,5],[46,57,67,42,56,53,55,44,64,59,46,5,48,30,45,14,59,34,44,35,14,29,55,19,27,38,37,52,48,36,61,41,18,18,36,20,27,58,28,27,3,68,19,8,47,61,52,38,43,43,27,0,9,47,39,35,55,14,14,20,52,57,48,47,40,26,1],[5,60,38,39,57,49,10,6,5,26,40,58,24,30,23,56,51,0,48,19,8,6,33,8,42,59,35,28,23,20,22,62,44,35,1,2,39,18,33,27,54,65,27,67,5,24,33,21,29,41,7,49,57,58,30,19,5,36,42,9,52,11,11,54,13,66,33,56,9,14,40],[43,31,36,22,12,25,25,63,30,36,34,63,0,33,60,65,0,65,44,49,8,34,52,24,7,58,48,68,29,59,1,10,61,18,56,43,19,13,8,46,0,53,21,45,63,3,3,16,6,9,50,58,32,41,33,6,49,10,10,21,56,14,50,41,41,41,41,68,25,30,32,43,11],[5,7,12,64,56,15,14,25,16,25,46,45,59,49,38,9,57,8,8,52,30,8,33,31,65,28,3,43,65,55,29,29,41,24,23,38,53,44,67,47,40,43,43,11,21,11,28,21,24,14,68,8,17,40,27,46,47,52,66,56,14,34,48,23,3,66,27,3,45,46,50,68,57,37,51,63,55,28,65],[54,19,56,46,38,56,58,26,66,32,4,28,47,60,57,63,3,6,59,4,9,52,15,11,20,14,21,48,26,27,66,15,49,50,57,67,42,23,17,39,56,60,42,26,59,36,56,43,49,49,61,47,6,64,33,44,7,10,23,12,32,62,26,16,42,20,45,49,48,17,26,18,60,29,50,19,46,2,31,30,60,63,44],[61,38,8,47,24,4,62,44,50,16,25,57,48,40,24,13,26,18,12,31,30,67,14,53,65,31,41,61,25,8,8,60,51,40,41,40,1,3,2,38,33,25,67,7,66,60,42,26,62,52,6,50,68,30,65,0,26,62,23,64,1,42,30,25,48,43,23,19,3,62,7,24,13,27,54,34,51,43,44,37,7,1,49,17,55,3,6,10,46],[63,57,51,60,8,34,25,52,22,7,53,59,30,60,2,32,40,43,41,43,20,0,63,68,39,10,25,33,39,19,1,41,7,68,21,20,44,49,40,36,17,8,4,57,18,7,27,7,22,32,34,26,11,56,14,30,66,35,19,25,27,62,32,45,62,22,46,67,38,54,63,47,42,36,43,16,61,44,13,49,44,21,49,64,8,26,11,39,4,50,50,44,3,40,53,27,2],[29,30,47,20,31,3,21,3,38,39,10,53,1,46,50,4,56,56,8,27,2,10,12,24,38,30,42,39,32,44,44,14,54,18,6,4,27,65,38,26,57,10,19,35,23,48,7,66,57,66,66,26,57,11,7,23,53,26,2,41,15,66,34,14,13,24,67,61,43,46,59,10,42,5,39,45,63,42,40,37,21,36,67,29,68,68,39,22,1,18,3,43,9,52,47,5,62,56,18,50,19],[29,12,66,43,17,67,43,13,5,52,38,14,27,68,18,67,64,63,42,11,49,16,18,68,0,47,66,31,58,19,68,63,59,60,37,4,4,4,0,61,18,31,14,31,44,5,44,56,20,49,51,29,53,65,10,9,0,55,50,1,41,1,4,54,23,12,17,64,63,12,51,24,47,31,26,44,21,6,22,33,42,20,47,43,13,25,49,65,39,13,45,7,12,6,62,40,17,15,0,18,11,19,17],[7,54,57,20,55,43,41,61,2,52,19,23,63,9,17,33,3,35,30,49,9,27,12,64,67,30,67,7,14,66,55,19,35,65,68,20,42,22,51,59,6,22,3,49,1,25,38,49,44,12,14,43,57,14,45,19,31,15,21,22,18,62,63,29,56,57,45,55,51,19,31,59,21,57,27,12,61,4,23,52,11,25,24,24,49,34,27,57,27,3,14,16,29,45,31,41,16,30,20,57,58,33,12,50,0,8,51],[38,58,63,37,28,47,14,36,59,52,44,51,0,64,60,42,3,49,3,43,5,46,1,44,20,8,38,33,31,51,7,60,63,54,61,50,27,27,15,52,57,35,53,44,56,1,23,18,34,6,57,56,5,39,43,44,51,26,36,42,23,45,65,25,12,26,58,23,55,27,40,24,43,44,30,42,17,50,3,40,24,8,52,62,33,45,54,52,16,6,12,24,15,46,30,5,60,35,36,0,2,12,3,40,21,59,28,65,31],[4,51,36,51,32,62,63,65,64,22,66,38,1,33,57,59,48,17,6,37,60,17,6,10,68,42,59,55,38,52,30,58,42,52,49,56,50,65,66,0,37,20,11,24,54,67,65,6,3,42,26,5,54,0,47,58,57,53,63,67,37,49,25,36,58,53,18,31,51,50,23,11,62,4,53,9,8,40,51,14,34,47,53,18,2,67,38,50,62,52,52,13,45,21,14,59,67,36,42,64,64,36,4,26,57,57,52,7,34,44,4,41,11],[67,19,7,41,47,40,37,44,26,59,65,11,13,60,36,27,67,24,60,48,42,8,9,64,25,14,10,31,19,46,47,5,21,58,9,36,45,59,49,11,25,17,41,34,63,23,42,34,0,61,58,57,2,60,33,64,8,39,2,20,13,63,19,1,67,27,18,16,7,7,65,0,5,42,37,8,47,53,16,26,18,51,7,11,0,59,35,34,13,60,17,65,13,12,64,41,19,38,8,52,55,50,35,65,59,49,9,1,56,23,38,39,25,18,26,32,65,51,55,9,25,41,3,22,4,55,38],[21,2,18,44,17,55,17,27,16,30,28,37,5,61,3,7,14,11,18,4,36,30,53,24,44,32,13,43,0,8,51,30,5,30,26,46,64,3,6,2,8,35,61,17,65,22,15,26,24,27,38,53,63,33,63,23,40,32,30,29,63,24,39,4,36,3,35,67,38,38,66,29,51,36,22,31,9,20,44,13,26,57,55,42,21,59,51,67,39,44,33,18,18,60,59,48,27,50,61,16,25,65,22,42,16,49,22,37,8,56,14,13,51,49,24,65,49,12,67,62,20,68,18,48,1,27,57,28,49,54,1],[37,9,12,57,34,36,66,58,36,7,10,0,1,42,3,14,36,2,41,22,59,63,42,42,68,49,4,59,25,37,62,39,8,34,37,1,53,56,35,39,32,56,14,52,22,29,48,68,51,10,53,50,47,25,21,57,36,39,1,18,50,7,7,49,42,56,40,65,68,64,38,57,45,19,58,20,4,35,55,40,37,56,63,22,42,9,40,1,27,13,64,40,46,22,46,58,19,20,67,0,51,35,36,59,44,56,4,66,67,50,32,59,65,55,23,40,12,12,56,7,67,8,36,67,51,16,50,5,30,10,45,34,56,65,3,1,6],[30,20,21,54,56,32,21,7,31,47,47,60,31,47,37,68,37,11,11,42,44,1,67,16,47,60,11,64,0,65,50,50,45,44,66,13,60,47,56,36,1,17,6,64,12,36,46,67,14,44,40,37,52,31,63,34,64,5,60,35,2,49,47,34,59,58,11,17,42,32,40,10,67,22,56,41,21,3,7,31,58,25,33,11,22,27,51,54,51,0,41,56,13,66,8,22,45,48,42,13,52,21,40,2,19,16,4,39,35,16,51,47,18,17,51,65,25,16,50,32,8,51,44,11,39,35,20,51,68,10,22,64,21,35,0,65,34,30,9],[9,21,68,18,64,57,60,54,47,51,10,68,5,6,4,36,62,48,20,37,45,23,5,13,14,59,15,13,67,29,5,13,36,55,15,3,63,30,43,34,16,46,1,22,57,61,10,67,65,32,8,60,34,67,63,52,61,65,16,56,37,27,8,52,41,42,15,61,63,58,39,22,10,12,68,26,28,1,32,52,47,36,40,24,55,33,24,11,55,37,1,47,10,2,17,38,65,11,3,55,21,46,15,64,27,45,4,19,45,58,45,16,58,38,45,42,65,7,35,17,40,36,51,48,7,65,6,43,53,17,17,52,12,22,46,56,1,48,17,46,61,0,64,14,42,6,13,46,25],[8,14,12,49,63,57,53,55,1,29,37,1,43,19,10,57,12,0,46,4,8,40,68,60,41,14,44,12,15,3,11,2,47,37,9,68,33,40,2,51,18,0,31,36,56,27,63,18,35,58,59,9,68,34,64,27,13,39,17,60,22,6,33,28,11,48,30,15,10,59,58,60,4,5,1,32,16,12,2,67,13,1,15,38,62,4,21,50,54,33,9,12,47,63,54,63,57,24,47,32,47,59,50,8,58,61,39,50,5,27,51,39,2,37,56,61,29,62,32,20,14,59,47,46,65,16,1,46,41,53,21,64,13,27,62,46,45,5,68,5,8,51,64,64,39,27,43,34,53,3,32],[11,35,8,34,5,43,27,22,53,12,27,5,11,61,3,28,52,38,23,33,16,55,16,48,54,37,9,55,45,38,2,8,15,24,16,48,1,6,16,32,1,5,61,29,37,28,40,52,48,41,29,8,28,46,19,24,10,44,57,29,41,29,7,52,48,63,2,65,55,60,11,53,39,53,9,35,5,24,55,51,14,2,25,63,35,42,33,14,42,31,65,8,21,33,60,47,64,42,33,61,54,62,15,54,63,20,42,7,26,68,26,25,0,20,51,11,49,41,50,47,1,20,54,38,30,20,1,33,10,55,2,68,51,53,5,55,30,6,13,21,62,7,16,35,39,15,47,25,3,46,5,42,58,37,33,59,28],[50,54,7,60,32,52,3,56,52,46,35,47,34,45,3,40,51,40,23,37,39,6,23,10,36,34,16,8,54,2,48,44,19,46,14,36,38,57,68,54,50,7,52,4,53,31,18,18,67,55,31,55,40,44,68,21,44,0,41,34,29,7,54,55,30,42,24,26,23,66,19,3,49,3,53,52,31,50,43,56,34,24,6,35,1,9,68,50,66,28,62,39,2,56,27,21,63,50,47,17,36,42,35,24,34,46,30,29,33,1,68,64,21,24,58,11,18,68,50,13,37,59,10,60,5,30,22,37,44,64,64,14,42,34,48,12,18,34,18,6,5,37,54,23,40,58,41,67,21,56,11,9,55,5,60,60,62,32,62,62,39,24,20],[56,26,63,66,54,8,45,20,35,42,45,21,4,56,29,66,19,67,34,31,27,33,54,13,22,59,28,8,36,33,3,16,54,68,26,47,45,63,62,38,22,42,26,65,8,46,41,7,10,39,51,50,34,15,65,7,37,58,63,63,30,61,38,66,13,32,13,23,50,1,58,58,25,66,62,2,67,24,23,11,21,9,30,58,25,13,30,42,46,43,28,8,44,64,1,49,60,4,61,38,59,21,16,9,25,55,62,65,64,38,60,32,54,27,33,52,14,63,48,13,31,35,13,7,16,64,40,33,45,29,58,7,9,59,67,56,47,54,37,34,24,18,23,0,18,62,20,14,10,23,41,7,5,64,54,40,38,42,37,47,28,46,28,17,67,46,7],[47,32,66,23,11,36,35,3,22,50,59,4,51,13,51,37,49,19,20,37,0,19,16,20,7,16,53,10,45,52,53,41,42,13,37,15,30,46,64,52,7,2,2,39,25,31,33,62,35,47,2,60,65,59,64,13,18,42,44,62,36,1,68,49,60,8,19,57,46,6,38,43,31,1,14,35,67,45,66,63,2,9,12,43,54,35,32,48,52,63,37,57,41,48,64,11,26,64,3,15,18,61,61,29,16,33,67,26,12,16,22,17,1,33,37,13,39,8,25,14,65,38,18,46,47,26,11,64,43,28,55,48,35,34,9,58,6,10,29,13,18,41,55,26,26,18,8,0,53,34,53,62,46,41,27,30,64,0,67,23,7,27,56,51,61,29,33,66,30,63,58,1,58],[4,28,59,6,13,7,27,22,13,34,20,55,53,39,62,45,29,51,30,30,65,48,53,58,10,13,36,52,66,36,67,66,5,14,52,3,28,41,29,12,11,41,62,67,37,68,68,39,37,45,44,61,17,6,66,4,2,48,19,33,23,50,29,37,28,46,59,64,19,7,27,27,22,43,13,51,54,59,59,37,58,53,50,23,46,37,6,29,22,22,16,48,64,12,53,37,0,23,14,55,10,44,38,9,0,31,6,35,39,42,22,27,39,0,65,28,57,24,14,0,53,26,53,31,21,22,21,16,47,10,39,4,52,46,40,22,52,19,35,44,66,38,59,27,35,33,25,45,67,63,17,61,38,57,14,55,9,56,56,33,63,16,68,68,58,17,45,9,53,4,3,65,29,35,18,61,34,58,0],[13,55,22,49,14,13,22,42,12,21,36,8,25,25,67,4,25,68,55,68,60,32,63,49,15,52,65,58,31,61,65,42,12,47,50,54,45,8,59,1,34,9,40,31,54,34,16,12,38,47,66,40,51,53,6,5,45,12,43,14,11,29,45,22,56,25,29,68,12,29,0,45,47,44,61,6,12,49,61,41,61,56,42,25,19,66,45,18,4,13,57,67,68,35,37,67,57,68,36,29,4,40,65,39,54,57,15,31,18,22,7,58,49,43,2,11,40,63,27,31,50,52,38,42,61,54,33,40,51,29,35,19,63,45,12,39,49,63,59,1,27,29,41,27,15,12,31,20,46,54,1,2,6,63,2,15,8,40,12,19,65,67,60,9,38,38,7,63,35,22,39,11,60,14,7,53,25,33,3,22,23],[14,8,33,10,50,49,49,59,23,52,30,4,23,42,57,55,37,43,31,47,47,45,13,57,54,57,33,6,49,28,14,59,28,31,52,48,22,45,21,59,8,33,60,40,65,24,60,55,65,13,67,7,17,27,51,66,57,58,40,26,25,17,16,21,65,65,28,0,12,6,8,68,8,44,14,58,14,26,59,25,9,31,44,25,34,44,43,6,12,17,55,49,11,4,6,17,54,14,13,67,27,26,43,52,34,53,40,35,6,53,6,1,50,22,39,14,19,29,47,51,15,4,64,31,5,53,65,42,23,12,28,2,45,53,49,36,67,32,61,33,30,68,34,53,61,62,25,48,38,46,4,25,46,9,58,43,66,47,20,13,66,22,11,34,21,29,58,39,14,16,62,2,35,30,26,35,20,57,33,8,59,11,35,35,42,22,30,5,22,60,65],[12,18,35,23,63,52,41,16,42,51,12,4,18,46,36,54,54,6,25,58,26,11,26,9,58,55,16,1,31,59,1,51,66,54,33,47,22,17,57,51,44,39,29,6,8,18,48,7,24,11,10,21,27,51,29,13,67,38,14,51,20,2,66,54,27,58,50,20,41,44,13,23,1,65,57,33,23,31,14,61,26,51,18,14,59,49,67,59,17,27,53,50,67,55,37,0,0,64,39,20,12,63,33,51,6,62,63,63,3,37,42,38,11,63,35,39,62,33,17,24,61,17,68,4,59,43,65,1,26,48,17,67,52,1,33,65,13,18,6,38,42,13,37,11,62,64,33,36,44,44,44,41,63,6,37,39,16,55,0,58,66,54,40,8,6,35,61,26,41,42,66,30,48,64,27,22,37,50,28,43,46,50,35,11,19,9,3,14,67,49,43,52,53],[8,41,8,12,29,31,47,43,23,55,36,19,9,29,12,40,28,7,1,48,61,43,67,19,10,0,38,11,21,45,54,11,18,64,65,1,59,54,14,64,26,6,57,27,2,29,62,55,62,29,63,18,65,14,64,65,18,1,42,5,3,29,68,39,65,60,4,25,32,22,18,43,23,9,35,27,57,48,31,41,31,22,45,31,8,21,27,21,20,19,32,62,4,50,40,56,56,1,40,43,47,29,38,59,8,43,45,29,16,38,60,32,15,1,41,13,6,56,11,42,52,33,22,19,66,40,24,43,12,11,65,43,19,49,67,63,19,63,32,37,4,24,27,31,19,20,28,45,28,14,52,54,24,28,12,32,6,12,29,2,53,56,8,58,8,41,1,2,11,30,62,49,59,39,14,9,23,26,37,42,7,6,58,60,33,45,9,1,8,44,7,22,48,24,39,55,5],[65,56,2,19,3,40,6,62,33,62,58,59,47,61,44,24,57,68,0,48,37,3,29,33,33,27,53,28,12,9,7,65,62,54,24,31,42,48,40,48,46,22,52,31,33,27,14,19,26,21,39,31,59,55,15,44,57,58,53,26,65,11,25,1,6,46,48,52,29,18,60,31,29,13,38,31,51,7,29,46,15,51,30,19,54,29,19,24,67,15,1,32,35,36,0,35,31,29,38,35,51,28,19,13,49,60,3,1,15,59,58,60,22,51,12,15,23,50,3,33,35,38,19,41,45,9,35,68,33,57,36,27,65,61,12,3,4,39,37,21,51,54,19,28,49,46,50,27,29,63,49,11,37,59,67,30,14,65,6,44,61,33,6,40,45,68,62,66,53,14,63,42,31,56,49,62,20,13,25,11,31,61,57,44,26,0,29,4,54,14,7,33,9,42,15,68,1,18,41],[29,4,8,46,61,45,43,20,51,35,5,16,50,29,37,35,21,16,48,60,51,17,4,35,26,54,3,51,25,5,38,66,68,64,36,37,49,62,25,44,7,36,55,37,32,58,12,64,12,40,6,8,8,16,37,8,68,50,19,33,63,42,53,55,21,56,8,39,62,15,52,36,54,8,51,41,18,46,24,17,8,24,43,55,58,67,2,30,59,63,30,27,7,9,65,43,68,21,44,54,62,30,10,13,16,15,2,54,36,67,5,63,23,48,49,38,43,62,28,48,66,53,6,60,21,49,28,62,60,4,20,8,23,2,67,21,64,47,25,3,34,54,17,50,37,28,57,2,60,9,20,2,9,5,26,19,14,61,23,5,32,22,31,61,63,58,39,33,41,10,53,26,31,0,66,33,53,14,12,24,44,35,57,63,30,21,2,54,24,55,25,12,14,27,4,40,63,60,17,53,60,0,11,12,15,21,39,60,63,68,66],[40,61,35,10,25,44,65,60,34,60,49,60,56,25,49,0,5,62,6,27,40,59,43,26,29,47,34,45,18,23,12,38,0,0,40,20,65,34,41,20,21,24,44,47,58,30,55,45,7,5,45,68,61,36,49,24,37,18,7,45,9,35,20,15,60,67,62,46,26,3,5,11,2,29,49,24,3,57,43,37,57,59,23,26,55,25,41,54,2,67,65,59,22,31,4,28,15,23,17,37,8,33,13,65,3,64,17,3,9,12,60,50,27,60,18,20,50,46,51,32,28,18,21,55,36,51,15,56,45,56,40,46,12,61,2,17,40,54,29,63,11,1,32,33,37,38,26,22,64,0,48,26,55,4,20,21,29,30,20,36,2,52,4,45,13,2,48,34,22,62,30,61,44,40,15,47,66,8,22,51,33,41,57,35,50,20,53,44,6,37,28,58,22,28,23,68,68,32,65,49,58,43,60,55,38,52,19,45,29,58,65,65,55,32,19,61,24,61,8,16,53,46,16],[29,66,14,53,67,46,8,56,20,17,20,65,33,48,5,47,40,15,21,19,65,37,9,7,52,45,51,53,6,20,24,24,65,37,24,44,18,30,41,64,36,23,24,53,66,64,19,44,32,29,14,67,6,14,29,46,40,62,19,0,58,51,60,49,34,32,60,10,16,29,31,41,39,43,47,7,26,6,11,54,41,39,3,32,48,30,40,11,13,4,4,15,11,24,51,43,1,56,12,34,54,1,68,7,33,28,14,40,24,3,23,37,56,11,11,65,36,9,12,26,63,21,2,62,15,42,54,13,49,8,43,54,13,18,27,57,68,20,46,1,51,13,65,0,46,38,33,63,62,7,17,67,4,4,7,43,38,35,20,66,14,40,58,57,24,65,52,67,27,37,33,13,47,66,41,26,39,29,16,38,67,43,25,48,54,67,61,62,41,37,28,42,37,8,19,52,50,33,45,60,30,35,29,10,39,5,56,27,52,25,26,19,60,24,25,38,60,18,9,68,25,9,21,56,23,10,12],[23,9,57,28,23,0,8,7,64,31,10,53,39,26,42,18,34,29,25,1,16,33,58,44,6,39,35,31,41,11,62,1,48,48,58,13,28,38,32,12,30,10,35,1,16,31,40,22,52,11,44,1,30,3,27,30,47,51,66,41,65,38,59,24,5,12,26,49,3,56,59,28,34,62,42,17,42,29,29,10,60,37,12,36,43,19,26,34,35,48,25,32,23,50,55,23,2,38,26,26,68,53,67,62,38,27,57,58,4,42,18,16,67,18,36,11,46,38,67,51,49,33,31,25,46,42,23,62,49,46,5,56,6,59,23,15,10,33,21,24,32,17,24,15,47,51,32,33,57,1,18,18,45,49,0,2,8,68,56,16,38,31,5,65,64,40,9,31,0,17,32,4,63,47,31,44,53,10,26,67,23,19,22,32,64,15,21,2,62,19,46,3,6,20,54,0,20,17,0,40,68,4,56,9,32,1,2,14,1,3,30,32,13,44,23,4,46,67,28,33,58,56,10,46,36,40,43,9,47],[0,8,3,62,29,50,2,51,43,34,38,9,6,32,59,66,24,39,44,35,7,42,2,13,58,42,22,3,6,41,20,18,28,13,14,52,26,5,32,21,33,8,9,60,7,48,21,8,63,3,51,55,50,18,8,27,37,14,2,47,34,23,42,42,2,42,38,43,53,21,33,65,20,11,39,48,64,53,5,4,68,23,67,58,68,8,11,2,16,52,11,13,7,56,41,33,24,15,22,48,44,60,67,39,68,19,1,3,38,20,16,13,5,36,14,4,43,51,47,20,29,66,48,21,23,5,55,53,30,57,15,8,44,16,50,64,13,12,7,36,22,7,3,3,1,28,35,17,8,5,34,38,57,46,31,26,59,23,56,42,32,56,11,38,43,29,8,24,63,50,66,19,64,26,3,15,32,22,0,10,4,60,58,59,10,37,57,17,31,3,47,42,57,2,62,36,35,38,37,64,7,10,18,67,23,24,50,9,17,54,19,37,64,0,26,8,39,46,53,35,7,68,40,18,26,44,57,55,67,56,33,4,49],[0,67,66,2,17,33,30,52,46,0,51,41,2,31,33,11,65,66,6,15,16,42,45,3,55,52,32,61,47,5,5,55,61,64,59,37,12,38,11,3,25,45,66,42,39,5,5,59,22,20,33,57,44,11,52,8,23,8,60,9,48,67,6,20,58,64,15,38,62,33,34,30,52,46,31,19,52,33,64,45,2,40,25,23,9,54,26,43,33,52,49,57,12,68,36,28,64,26,43,37,43,14,45,16,40,57,36,51,53,46,59,61,66,9,25,45,17,18,17,6,41,31,36,12,8,26,15,54,6,23,33,39,41,6,68,33,65,53,32,37,4,59,68,63,33,32,2,27,46,12,38,29,6,52,26,33,27,10,31,6,13,14,29,32,46,65,9,48,39,51,26,47,5,6,12,39,50,19,37,11,5,14,8,43,56,64,3,49,22,12,10,44,41,16,29,41,27,48,25,27,58,32,54,57,32,27,49,45,27,48,6,5,67,28,16,46,63,16,53,16,23,60,38,8,31,53,7,13,1,4,9,34,19,33,34,41,7,56,28],[22,32,63,49,16,20,9,12,45,5,40,46,17,48,11,30,27,2,47,43,50,56,45,0,8,50,21,39,28,23,66,14,48,63,59,31,29,26,19,62,29,31,52,44,64,49,42,18,27,8,32,54,18,35,11,52,36,42,21,21,25,37,5,48,47,39,45,48,22,3,28,55,55,20,62,23,32,7,37,68,23,4,65,8,34,19,23,53,35,20,13,35,45,68,44,11,56,52,58,49,14,0,43,66,63,18,29,63,58,34,26,30,9,21,4,47,59,28,1,64,40,5,22,0,11,10,13,42,51,15,68,42,22,38,56,38,1,47,63,27,22,33,58,40,3,15,63,55,2,33,54,22,67,32,48,13,30,1,41,0,15,3,64,66,57,31,13,63,38,34,13,61,31,38,51,18,17,12,8,13,30,56,51,33,17,66,12,15,9,7,4,51,63,6,7,55,31,40,4,13,11,50,24,1,65,3,47,1,14,63,23,8,0,9,50,37,62,37,57,3,40,27,22,32,5,34,50,60,36,68,16,51,37,2,17,8,7,7,21,52,21],[46,2,11,12,34,2,3,26,18,38,21,17,48,21,14,67,23,10,14,34,58,27,14,40,10,17,28,13,34,61,43,24,27,7,6,14,38,11,63,40,60,30,13,42,51,21,68,13,2,39,27,11,4,9,32,50,46,55,5,57,45,41,15,25,1,0,64,56,14,42,40,50,60,55,44,15,30,47,4,21,13,40,41,52,20,0,55,57,21,35,53,36,51,16,2,57,56,18,64,65,8,52,50,56,28,54,64,42,28,0,54,7,68,64,19,16,59,54,55,27,25,59,62,59,64,28,21,31,28,65,58,24,50,66,12,35,50,12,24,56,65,53,49,31,45,31,23,58,46,48,50,7,56,56,29,34,45,14,40,13,43,37,32,14,19,59,65,53,23,49,19,51,16,35,26,40,35,16,24,6,54,0,65,35,2,9,24,10,28,45,2,1,27,56,63,1,45,36,16,52,55,56,28,31,52,4,52,38,3,12,13,10,56,49,43,51,30,46,7,66,53,20,26,29,19,26,18,10,2,19,1,67,53,65,24,22,59,62,58,45,2,40,12,64,33,67,58,23,54,49,10],[38,5,35,14,38,63,25,4,35,34,63,29,11,18,10,40,30,16,17,41,14,50,47,65,39,50,67,9,31,19,30,45,5,17,31,30,45,0,16,9,47,63,17,17,8,6,65,50,16,23,42,68,5,59,24,66,7,52,9,55,54,6,36,5,42,35,52,27,63,46,52,10,36,14,33,64,56,44,8,56,13,25,67,56,45,21,8,41,50,61,66,26,7,60,33,6,9,25,65,5,55,0,45,47,55,20,35,3,31,24,38,2,50,25,37,1,53,20,51,43,53,25,4,23,46,1,18,1,27,52,26,36,8,16,10,30,46,6,58,68,36,42,15,26,15,37,32,68,47,44,15,2,36,26,47,1,20,58,26,14,57,33,2,60,18,28,67,56,64,40,48,14,3,24,8,36,67,28,43,58,19,58,28,22,22,37,6,22,24,67,45,28,16,25,60,52,62,61,31,4,48,40,46,36,46,4,28,22,6,1,44,61,59,35,6,4,30,60,25,0,51,20,9,10,65,49,2,25,43,52,20,64,37,60,23,64,47,59,39,46,13,23,60,25,52,8,19,31,50,59,44,57,34,31,62,64,29],[6,67,20,64,2,4,14,66,22,6,62,42,42,65,49,62,43,53,39,42,4,48,61,22,50,66,52,23,34,29,29,66,50,58,9,61,58,34,54,33,66,39,12,61,62,38,31,15,62,26,10,21,8,0,57,41,51,35,59,47,7,30,55,43,48,26,57,11,18,37,26,24,64,65,56,36,25,45,45,44,1,59,12,35,53,28,2,61,6,44,12,43,3,26,24,43,58,9,59,34,37,47,41,20,63,53,49,32,9,28,22,4,18,41,65,60,18,0,44,16,1,34,39,53,29,40,38,7,6,20,62,20,18,11,9,8,47,17,44,51,22,50,19,52,57,6,24,47,22,1,25,18,68,66,46,2,42,23,18,22,43,24,25,5,0,18,33,65,9,65,59,52,15,11,16,9,50,25,36,9,15,37,56,52,62,26,62,53,12,63,3,27,26,21,26,33,29,64,45,38,34,39,13,13,50,0,33,21,1,60,39,3,37,15,7,8,10,59,62,57,9,16,15,33,64,45,24,46,10,41,50,30,23,4,52,4,19,3,63,24,43,2,55,49,57,59,5,64,1,52,11,53,66,0,23,2,56,64,6,29,26,38,35],[2,21,50,47,16,35,38,29,16,2,51,12,3,64,30,55,57,59,61,65,28,35,5,42,20,65,20,24,54,42,0,36,36,4,49,24,18,30,13,50,12,5,9,61,40,14,15,39,12,36,27,26,45,34,39,55,34,29,4,65,59,54,55,37,63,27,45,54,30,40,66,19,49,42,20,35,4,6,6,19,60,21,66,18,48,49,48,25,10,6,34,32,47,66,34,14,29,17,12,20,2,31,41,34,19,31,10,59,39,23,24,51,38,40,48,31,9,51,24,65,25,28,38,67,57,18,26,12,22,14,54,52,45,1,53,51,39,60,3,56,1,65,35,1,28,10,3,4,43,8,6,56,39,9,32,51,48,33,39,13,55,15,63,51,4,58,56,53,42,37,63,51,11,3,38,19,29,28,6,28,59,8,63,39,66,68,26,37,16,55,61,19,12,51,23,6,31,63,13,40,10,54,46,16,63,35,5,28,24,49,40,25,13,2,7,36,11,59,10,24,20,8,10,10,58,36,19,31,55,23,44,16,37,17,3,22,25,12,49,3,63,24,44,23,60,14,42,67,67,31,68,68,37,64,66,59,36,35,44,58,23,6,38,64,26,26,38,42,8],[23,39,18,20,23,64,24,13,4,14,12,50,22,13,18,12,53,31,47,36,22,53,61,5,67,36,10,25,63,40,52,33,64,3,52,15,57,36,26,23,29,41,21,36,12,32,15,53,2,68,21,7,24,11,43,50,44,29,15,43,30,36,6,12,30,67,3,65,0,25,24,39,8,3,16,27,10,63,41,28,64,28,22,65,64,61,48,67,37,11,23,24,3,40,26,47,53,67,7,56,43,57,45,21,25,65,3,20,21,33,12,3,8,18,33,3,64,57,8,16,35,7,19,22,67,4,4,67,45,0,50,61,63,30,12,36,52,51,40,36,33,53,20,34,61,49,27,27,57,38,24,45,64,26,61,54,61,2,13,68,17,32,15,56,22,53,33,36,58,16,58,37,50,14,60,0,66,39,26,33,63,0,35,47,0,57,42,59,32,61,40,40,27,15,67,27,29,59,2,26,8,54,65,55,15,67,29,41,44,61,62,15,60,57,66,39,67,45,25,43,68,3,51,4,48,7,9,67,12,4,62,18,16,1,37,47,57,54,58,26,26,8,7,68,55,58,58,26,53,26,46,14,34,51,29,38,27,28,66,2,25,14,31,57,48,65,40,48,34,52,23],[22,57,10,45,36,59,46,42,6,67,35,4,54,20,8,10,23,3,1,55,8,32,17,67,60,37,21,44,10,59,4,4,5,29,20,58,2,1,10,48,5,32,35,55,14,56,62,57,24,15,33,7,8,1,46,53,39,36,59,65,17,40,16,25,37,12,51,14,66,36,64,55,65,5,62,61,36,32,34,51,32,64,6,12,56,50,36,24,63,60,42,58,2,67,62,38,64,31,41,52,34,30,3,55,32,58,39,43,2,23,5,67,68,44,52,66,6,10,51,68,19,63,10,5,0,13,3,25,51,55,41,1,23,31,37,32,15,63,21,36,19,5,16,52,35,41,9,45,46,21,29,13,66,66,48,0,12,17,51,16,10,20,8,22,48,12,27,19,61,27,54,15,45,7,26,67,59,3,31,19,58,36,21,59,67,48,19,10,14,4,67,9,34,45,36,16,65,38,9,44,68,23,31,1,28,31,38,8,31,14,60,14,67,45,63,65,42,4,28,14,24,20,12,4,51,32,59,54,26,18,26,30,9,3,32,22,5,58,6,6,20,62,31,23,62,37,42,32,27,32,63,67,60,40,56,21,50,26,26,52,27,67,47,53,46,19,66,4,1,36,14,67,40,47,18,15,48],[52,10,48,51,26,53,9,62,56,51,6,7,37,33,43,7,52,42,19,68,18,35,13,3,43,7,67,16,9,13,3,19,18,19,9,37,20,33,61,56,42,8,45,20,36,57,1,9,16,25,1,35,16,45,20,25,8,53,43,8,34,7,65,58,3,29,45,62,35,8,20,66,4,1,6,27,1,49,28,40,52,47,14,6,38,47,27,64,40,45,31,63,25,43,25,52,59,44,61,19,40,12,64,29,52,17,30,26,66,30,1,0,48,42,9,40,13,29,29,52,8,51,21,5,21,52,53,41,5,43,27,5,22,4,22,34,1,11,38,37,54,47,43,39,0,0,28,68,10,65,13,50,10,40,36,0,12,3,48,31,44,36,4,43,21,64,46,47,29,16,55,68,8,61,8,31,48,20,39,50,46,24,52,1,22,11,57,30,58,26,20,24,43,48,12,49,57,33,32,22,6,5,2,34,24,9,67,30,34,23,32,27,50,32,3,7,33,1,20,39,37,5,18,61,7,4,7,1,25,32,27,40,46,19,29,40,53,58,67,55,12,21,36,47,24,58,63,64,0,31,50,17,55,21,16,10,58,68,43,68,18,41,63,1,50,57,22,41,43,3,0,11,33,11,1,57,7,59,46,58,50],[0,19,12,19,20,55,45,54,7,64,33,9,50,60,2,31,38,35,14,58,22,15,48,61,50,51,35,21,27,66,48,9,55,46,43,42,10,67,25,10,0,54,11,59,49,5,39,46,46,40,36,40,68,11,58,63,30,32,57,33,33,57,43,63,63,23,6,11,33,0,49,30,40,42,48,15,22,65,65,16,41,55,58,36,51,28,16,8,16,40,40,60,16,29,9,9,8,21,41,50,4,37,35,9,15,25,2,51,10,49,48,63,7,12,60,46,8,60,44,66,14,6,40,30,54,60,54,31,3,19,30,21,42,3,30,34,10,35,20,8,60,19,48,29,42,35,9,66,54,14,47,54,17,15,4,59,38,50,1,35,22,27,53,20,68,17,28,54,38,54,54,55,31,49,33,65,46,44,19,28,4,48,41,24,54,65,19,53,13,12,26,57,58,2,30,36,59,15,46,27,8,2,64,8,57,44,16,65,54,61,5,27,19,49,66,46,63,57,44,26,32,46,1,67,46,54,16,31,17,58,54,63,45,46,30,33,6,50,33,2,51,29,52,55,23,9,6,19,41,49,35,63,46,7,3,16,37,8,0,32,11,24,7,58,14,29,36,6,30,43,35,8,1,61,20,19,21,31,57,63,36,29,6],[9,27,37,30,23,65,19,37,68,64,4,39,4,68,65,4,67,27,33,51,33,57,23,25,27,23,18,5,45,31,53,10,55,45,45,63,34,57,13,1,19,51,35,56,53,12,12,55,7,36,34,31,27,49,24,7,14,66,9,20,15,67,55,53,67,22,38,51,25,22,67,4,1,44,15,33,13,64,66,57,50,36,56,42,3,22,61,59,54,38,32,54,38,1,62,67,0,67,4,40,11,9,28,51,32,26,39,44,49,38,8,40,16,0,29,65,59,7,68,30,9,63,9,33,31,21,65,59,18,60,19,36,63,26,29,9,56,19,52,17,34,46,68,62,4,4,12,43,9,38,20,53,26,33,9,20,40,61,39,29,32,23,4,5,23,25,15,17,31,66,62,27,3,40,17,49,37,47,1,47,23,61,35,6,21,50,27,43,56,58,18,48,1,37,43,20,10,50,48,42,56,49,18,53,3,33,2,17,30,18,32,52,31,17,39,61,10,22,11,6,51,44,56,31,67,38,51,30,14,31,36,41,6,17,21,31,46,67,18,64,62,24,27,34,33,42,20,12,63,7,52,41,20,1,26,46,35,24,23,44,9,29,44,52,8,47,61,20,40,20,50,36,25,2,55,50,59,43,24,51,7,63,44,34,16,32,19,36,29,47,34,60,64],[62,61,57,28,58,22,52,6,11,23,39,53,13,4,33,26,31,1,44,61,59,34,55,32,61,33,55,9,35,60,1,13,1,45,7,58,27,64,22,47,59,45,7,34,14,8,17,68,61,14,27,4,35,1,37,65,12,36,32,64,0,63,17,13,12,58,24,64,42,42,56,24,57,45,14,53,36,56,57,11,67,29,27,57,14,5,18,47,67,6,50,45,54,57,7,8,28,19,50,45,25,59,56,5,44,51,14,36,27,64,7,26,17,56,42,14,36,22,33,13,54,51,0,57,31,31,42,21,59,3,37,62,3,39,41,40,0,35,4,4,16,15,12,25,29,56,36,36,28,28,65,2,66,56,10,2,38,65,14,65,15,38,11,15,64,1,13,36,66,52,17,40,7,49,42,30,5,44,42,56,52,65,13,63,45,53,22,5,53,10,47,41,67,25,54,18,63,11,35,57,60,10,60,34,10,43,3,38,24,44,37,38,51,33,8,51,66,13,40,35,40,18,50,63,41,60,52,15,50,3,47,1,35,1,68,8,16,28,60,21,66,62,57,49,16,57,64,66,20,6,59,2,35,20,2,66,3,55,12,58,47,57,0,37,25,53,6,7,33,58,15,57,55,44,39,4,31,44,42,43,10,25,26,24,64,56,44,61,12,47,61,15,29,37,59,67,45,52,40,53,13,3,42,0,4,32,29],[31,66,56,68,24,31,52,10,48,10,3,41,42,15,54,21,57,5,52,32,68,15,37,30,54,20,0,34,27,36,25,68,51,16,49,13,10,64,22,46,47,35,9,37,29,38,7,62,23,63,17,52,39,32,6,25,14,33,65,21,4,24,21,68,67,56,15,25,15,37,63,14,1,6,59,14,5,42,41,10,65,34,62,28,16,1,6,68,19,17,58,14,46,9,44,0,2,0,20,68,28,60,54,2,6,49,20,57,59,41,63,3,42,13,50,13,55,47,56,54,57,53,7,47,61,56,37,33,13,29,50,18,57,20,22,22,30,66,60,55,28,3,24,49,50,13,33,62,43,27,25,37,65,54,49,30,40,61,57,58,34,15,9,31,43,50,65,10,0,57,33,61,5,16,39,5,54,2,10,62,56,8,11,38,53,44,60,62,42,12,59,68,28,22,32,62,52,7,26,11,51,21,36,68,27,63,58,3,55,32,25,51,55,9,1,43,18,29,46,5,8,17,15,40,6,58,26,28,65,28,0,35,67,13,59,30,56,58,15,57,40,62,44,34,51,39,50,9,18,21,42,68,10,32,41,51,8,51,45,57,53,18,62,11,23,1,6,6,58,66,51,66,68,3,66,16,3,22,19,51,55,47,21,38,49,25,54,35,15,66,52,2,7,66,31,1,55,21,28,33,38,44,67,61,59,24,24,24,46,17,64],[27,68,2,1,32,49,39,3,63,15,64,68,54,32,0,15,43,62,50,56,8,27,2,62,55,54,45,20,41,20,37,7,11,27,31,25,67,65,22,62,51,20,37,59,13,40,66,43,34,6,66,11,65,66,53,38,22,55,46,50,43,49,7,49,63,34,7,12,26,8,54,38,66,63,9,67,22,17,51,1,21,68,31,31,21,58,64,52,55,42,50,6,39,52,21,32,48,2,68,0,9,48,62,46,29,20,10,18,60,67,39,65,63,3,6,51,19,21,48,34,58,22,51,28,53,13,45,40,57,21,15,48,24,19,24,48,40,39,44,39,64,23,49,58,23,14,34,42,60,46,39,29,17,34,25,18,37,31,22,22,33,12,25,3,45,63,45,66,18,10,42,19,2,58,35,31,9,64,30,20,33,59,67,32,8,43,63,19,50,24,17,30,23,10,30,32,65,41,27,14,22,32,56,61,63,10,5,43,58,18,58,14,15,46,36,37,20,16,32,15,42,17,12,5,0,3,68,51,40,6,60,55,4,40,47,27,37,64,28,59,36,11,50,8,32,24,1,53,36,24,16,23,24,49,42,18,60,67,66,45,25,66,64,46,65,40,60,55,8,14,50,16,0,50,53,38,28,35,41,40,7,62,62,63,51,29,11,8,31,21,63,60,44,22,64,41,11,34,9,8,29,33,15,6,39,2,53,10,45,27,66,19,30],[23,12,52,26,26,45,46,45,20,29,28,27,25,1,4,4,65,20,67,1,50,19,32,16,13,48,10,27,52,13,59,65,50,67,10,36,36,65,51,10,60,21,37,45,46,56,7,23,43,16,16,32,42,12,27,25,40,7,49,45,55,20,19,42,37,2,51,9,36,44,2,28,58,43,49,38,44,18,64,5,8,62,48,54,43,1,36,50,25,46,23,58,3,62,16,8,38,35,57,65,57,27,54,48,34,9,8,58,17,6,3,17,30,37,60,13,9,5,10,53,66,8,63,66,59,33,64,46,65,63,52,18,31,7,49,38,53,14,68,58,33,28,57,1,34,5,58,59,64,41,6,1,7,40,61,32,42,15,8,27,21,68,44,36,53,55,18,21,8,19,46,11,38,12,37,54,67,46,67,31,50,1,67,60,12,49,35,23,14,47,39,56,50,31,57,28,8,41,63,28,58,2,53,0,12,40,10,20,60,26,54,44,12,67,57,28,55,39,37,59,8,27,62,45,37,0,54,26,48,20,15,5,54,59,25,30,19,17,27,4,29,2,48,28,55,40,29,21,32,55,32,45,43,29,4,5,32,63,15,68,59,29,44,28,13,38,18,38,5,38,52,17,57,25,34,44,35,68,32,16,6,47,39,52,31,50,3,4,27,1,41,52,25,21,27,65,35,1,67,46,17,58,48,25,27,60,20,1,44,19,2,13,27,39,23,7,20],[7,11,3,54,45,21,19,50,5,5,49,1,17,18,49,48,61,13,26,6,4,3,10,46,60,60,42,37,8,3,23,41,21,11,60,57,21,47,29,37,29,19,25,4,6,41,44,0,22,9,37,23,50,55,18,2,67,64,58,15,47,61,8,10,16,65,45,34,68,26,9,44,8,60,20,66,39,25,67,65,31,33,22,53,40,33,7,63,48,35,17,32,68,46,67,6,8,52,9,45,7,66,57,42,14,52,9,36,62,24,35,65,36,46,47,14,26,54,7,31,42,17,37,40,38,42,12,3,63,18,1,57,45,59,53,56,44,48,11,55,10,19,23,55,16,25,23,1,21,55,2,14,32,20,62,22,3,6,46,46,30,14,52,63,13,31,9,59,45,48,36,63,20,53,16,42,19,22,26,46,19,68,54,8,14,22,51,5,18,17,4,25,20,22,59,55,33,43,53,21,22,38,61,65,4,63,7,13,43,6,13,50,3,34,35,14,50,62,3,43,17,42,21,18,1,13,41,4,67,44,51,68,23,53,31,5,11,25,7,55,48,62,14,14,53,39,12,30,68,10,48,46,47,41,40,28,37,27,43,33,68,34,34,65,16,52,40,54,52,55,33,52,63,58,47,0,27,30,12,62,37,9,3,16,61,25,25,4,30,25,49,11,50,28,44,1,38,9,30,55,22,7,35,54,62,23,20,26,66,1,8,7,25,56,61,49,20,55,5,42,52,41,62,1,16,62,39,67,56,66,26],[22,30,24,25,4,47,24,17,2,24,46,17,55,33,48,15,31,56,20,27,9,27,60,41,34,45,33,13,47,43,15,17,59,31,38,57,55,56,46,34,1,6,0,60,15,29,42,67,38,32,68,61,51,49,56,60,12,39,67,47,22,55,18,68,30,44,35,56,40,18,42,9,58,35,14,22,37,8,36,68,54,51,9,68,13,62,54,3,53,21,67,61,48,35,59,31,38,43,31,36,41,28,34,36,37,57,51,66,67,53,47,0,1,4,68,24,66,48,52,31,24,0,38,1,29,5,46,60,62,12,65,12,42,40,56,6,65,27,31,58,60,24,53,4,49,7,5,20,65,49,41,64,58,66,24,68,35,12,32,17,46,19,46,68,57,49,58,1,19,36,14,67,39,8,35,57,46,35,44,45,56,51,66,59,27,48,35,25,24,25,24,24,60,47,40,32,42,10,43,37,42,4,26,54,65,38,35,51,55,33,64,18,10,2,40,27,39,47,12,11,24,51,12,37,40,57,58,63,57,16,39,58,36,24,48,47,17,58,56,16,34,14,25,3,6,25,39,19,60,64,31,8,34,34,61,64,29,45,4,67,41,52,39,44,58,21,63,9,64,1,25,11,9,9,54,1,50,32,8,50,63,53,52,2,55,41,11,50,55,67,32,57,20,36,68,29,4,13,1,47,55,67,0,19,27,52,0,36,20,10,37,6,15,59,59,14,13,58,12,31,66,22,66,40,58,62,30,19,43,2,42,12,33,59,52,38,33],[66,6,26,22,17,35,67,15,7,45,68,30,8,4,60,24,64,34,13,0,7,12,18,47,40,24,19,5,50,47,11,15,67,19,48,21,46,64,29,40,28,40,60,33,32,19,31,23,40,4,16,39,1,51,5,17,68,0,16,17,48,58,38,3,2,28,10,3,65,43,41,16,56,39,1,55,32,44,68,68,38,45,32,21,30,65,6,24,2,17,17,64,19,25,35,45,37,38,55,14,5,54,22,9,53,43,11,66,26,5,62,68,19,27,4,14,52,55,52,49,0,26,1,0,42,34,61,52,13,18,23,60,49,15,44,62,46,3,43,57,23,8,60,8,17,25,68,3,41,26,46,23,6,8,28,13,13,64,34,68,52,1,11,30,68,3,27,33,54,26,29,59,40,7,55,47,27,65,6,64,63,34,49,9,29,10,59,15,62,63,22,37,56,38,14,11,37,59,60,11,21,44,42,62,42,57,5,20,29,8,16,35,33,0,30,15,40,65,59,21,2,55,47,34,17,46,43,68,26,13,67,19,64,43,3,36,11,50,59,36,33,48,63,52,31,59,63,32,25,21,60,30,66,9,68,63,60,16,9,11,51,6,3,66,61,22,23,31,37,58,62,17,29,56,60,13,68,3,23,42,57,68,31,15,63,24,1,64,55,57,18,27,37,37,12,43,7,60,26,37,51,49,25,2,46,47,31,21,31,12,30,3,20,25,68,61,33,11,15,27,28,25,37,17,15,8,16,46,22,53,45,67,67,52,49,13,32,44,24,58,5,17,41,9,21,47,35]];

        // change_state :: () -> ()
        const change_state = () =>
        {
            const state = $(".setting").value;
            $(".go_state").innerHTML = state;
        }

        // go :: () -> ()
        const go = () =>
        {
            const key = KEY;
            const state = $(".setting").value;
            const password = $(".password").value;

            let r = $(".text").value;

            if(state === "Encrypt")
            {
                r = encrypt(key)(password)(r);
            }
            else // state === "Decrypt"
            {
                r = decrypt(key)(password)(r);
            }

            $(".text").value = r;
            navigator.clipboard.writeText(r);

            alert("Done!");
        }
    </script>
</body>
</html>

<script>

// arrays_eq :: [a] -> [b] -> Bool
const arrays_eq = xs => ys =>
{
    return JSON.stringify(xs) === JSON.stringify(ys);
}

// assert :: (() -> Bool) -> ()
const assert = f =>
{
    const result = f();

    if(result === undefined)
    {
        console.log(`ASSERTION UNDEFINED:\n${f}`);
    }

    if(result === false)
    {
        console.log(`ASSERTION FAILED:\n${f}`);
    }
}

if (TEST)
{
    // assert
    assert(() => 2 === 1 + 1);

    // arrays_eq
    assert(() => arrays_eq([1])([1]));

    // mod_neg
    assert(() => 4 === mod_neg(-1)(5));

    // cycle
    assert(() =>
    {
        const xs = [1, 2];

        return 2 === cycle(xs)(-1);
    });

    // shift_char
    assert(() => shift_char(1)('a') === 'b');

    // sum
    assert(() => 2 === sum([1, 0, 1]));

    // get_delta
    assert(() =>
    {
        const key = [[1, 2], [2, 3, 4]];
        
        return 6 === get_delta(key)(-1);
    });

    // encrypt_offset
    assert(() =>
    {
        const key = [[1], [1, 2]];
        const text = "AAA";
        
        return "CDC" === encrypt_offset(key)(0)(text);
    });

    // negate_list
    assert(() => 
    {
        const xs = [1, 2];

        const expected = [-1, -2];
        const observed = negate_list(xs);

        return arrays_eq(expected)(observed);
    });

    // negate_key
    assert(() => 
    {
        const key = [[1], [1, 2]];

        const expected = [[-1], [-1, -2]];
        const observed = negate_key(key);

        return arrays_eq(expected)(observed);
    });

    // password_to_offsets
    assert(() => 
    {
        const password = "ab";
        const min = MIN_CHAR_VALUE;
        const max = MAX_CHAR_VALUE;
        const range = max - min;

        const expected =
        [
            "a".charCodeAt(0) + (0 * range),
            "b".charCodeAt(0) + (1 * range),
        ];
        const observed = password_to_offsets(password);

        return arrays_eq(expected)(observed);
    });

    // encrypt
    // decrypt
    assert(() =>
    {
        const text = "I love pizza";
        const key_1 = [[1], [2, 3]];
        const key_2 = [[4]];
        const password_1 = "asdf"
        const password_2 = ""

        let success = true;
        let r;

        r = encrypt(key_1)(password_1)(text);

        success &&= r != text;
        success &&= r != encrypt(key_1)(password_2)(text);
        success &&= r != encrypt(key_2)(password_1)(text);

        r = decrypt(key_1)(password_1)(r);

        success &&= r === text;

        return success;
    });
}

</script>